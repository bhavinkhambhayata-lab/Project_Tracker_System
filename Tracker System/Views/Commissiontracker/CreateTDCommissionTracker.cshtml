@model Tracker_System.Models.Commissiontracker
@{
    ViewBag.Title = "CreateTDCommissionTracker";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<body>

</body>
@using (Html.BeginForm())
{
    @Html.HiddenFor(model => model.UserName)
    @Html.HiddenFor(model => model.Password)
    <section>
        <div class="box" style="width:auto;">
            <div class="box-body" style="width:auto;">
                <div class="clearfix"></div>
                <div id="tabs" class="nav-tabs-custom" style=" margin-top: -15px !important;">
                    <hr />
                    <ul class="nav nav-tabs" style=" margin-top: -6px !important; font-size:15px;">
                        @*<li id="lnkPIList" class="HeaderFont active"><a style="font-size:15px!important;" href="#tabPI" data-toggle="tab" onclick="GetData();"><b> @resourceSettings.getResourceLable("lblPI_status", "common", "PI Status")</b></a></li>*@
                        <li id="lnkList" class="HeaderFont active"><a style="font-size:15px!important;" href="#tabList" data-toggle="tab" onclick="GetData();"><b> @resourceSettings.getResourceLable("lblList", "common", "List")</b></a></li>
                        <li><a id="#lnkDetail" class="HeaderFont" style="font-size:15px!important;" href="#tabDetail" data-toggle="tab" onclick="GetData();"><b> @resourceSettings.getResourceLable("lblDetails", "common", "Details")</b></a></li>
                        <li><a id="lnkPreMarketing" class="HeaderFont" style="font-size:15px!important;" href="#tabPreMar" data-toggle="tab" onclick="GetData();"><b> @resourceSettings.getResourceLable("lblPreMarketing", "common", "Pre Marketing")</b></a></li>
                        <li><a id="lnkCommercial" style="font-size:15px!important;" class="HeaderFont" href="#tabCommercial" data-toggle="tab" onclick="GetData();"><b> @resourceSettings.getResourceLable("lblCommercial", "common", "Commercial")</b></a></li>
                        <li><a id="lnkPostMarketing" style="font-size:15px!important;" class="HeaderFont" href="#tabPostMarketing" data-toggle="tab" onclick="GetData();"><b>@resourceSettings.getResourceLable("lblPostSales", "common", "Post Sales")</b></a></li>
                        <li><a id="lnkLogistics" style="font-size:15px!important;" class="HeaderFont" href="#tabLogistics" data-toggle="tab" onclick="GetData();"><b> @resourceSettings.getResourceLable("lblCoordination", "common", "Co-Ordination")</b></a></li>
                        <li><a id="lnkAccounts" style="font-size:15px!important;" class="HeaderFont" href="#tabAccounts" data-toggle="tab" onclick="GetData();"><b> @resourceSettings.getResourceLable("lblAccounts", "common", "Accounts")</b></a></li>
                        @*<h5 id="DataShowPI"><b>Data Shown on Grid : PI Pending ,Order Process AND Tagged On PI = 'Yes' </b></h5>*@
                        <h5 id="DataShowList"><b>Data Shown on Grid : Order,Invoice,PI are Generate ,Tagged After Invoice ='Yes' AND Invoice Generate but Commission Sent To Vendor ='Not Null' </b></h5>
                        <h5 id="DataShowPreMarketing"><b>Data Shown on Grid : Invoice No Not Generate AND Tagged on PI ='Yes'</b></h5>
                        <h5 id="DataShowCommercial"><b>Data Shown on Grid : All Invoice Generate Data Show AND  Commission Working Sent To Vendor ='Null'</b></h5>
                        <h5 id="DataShowPostMarketing"><b>Data Shown on Grid : Commission Working Sent To Vendor =' Not Null' AND Commission Invoice Received ='Null' </b></h5>
                        <h5 id="DataShowLogistics"><b>Data Shown on Grid : Commission Invoice Are Received </b></h5>
                        <h5 id="DataShowAccounts"><b>Data Shown on Grid : Credit Advice Prepared ='Not Null' ,Credit Advice Details='Not Null' AND Credit Note Prepared ='Null'</b></h5>
                    </ul>
                </div>
                <div class="tab-content">
                    <!--<div id="tabPI" class="tab-pane active">
        <div class="box">
            <div class="box-body">
                <div class="table-responsive">
                    <div id="loadingMessage" style="text-align:center; padding:20px; font-size:16px; display:none;">
                        <span><i class="fa fa-spinner fa-spin" style="font-size:100px"></i> Loading data, please wait...</span>
                    </div>
                    <table id="TblPIListInfo" class="table table-bordered table-striped mt-4">
                        <thead>
                            <tr style="white-space: nowrap;">
                                <th class="HeaderFont" style="text-align: center;">Sr_No</th>
                                <th class="HeaderFont" title="PI No"><b>PI No</b></th>
                                <th class="HeaderFont" title="OCF No">OCF No</th>
                                <th class="HeaderFont" title="INV No">INV No</th>
                                <th class="HeaderFont" title="PI Date"><b>PI Date</b></th>
                                <th class="HeaderFont" title="Customer Name">Customer Name</th>
                                <th class="HeaderFont" title="Commission_Vendor_Name">Commission_Vendor_Name</th>
                                <th class="HeaderFont" title="Commission Type"><b>Commission Type</b></th>
                                <th class="HeaderFont" title="Commission Rate">Commission Rate</th>
                                <th class="HeaderFont" title="Sales Person Name">Sales Person Name</th>
                                <th class="HeaderFont" title="Tagged ON PI"><b>Tagged ON PI</b></th>
                                <th class="HeaderFont" title="Tagged On OCF">Tagged On OCF</th>
                                <th class="HeaderFont" title="Tagged On INV">Tagged On INV</th>

                            </tr>
                            <tr>
                                <th><input type="text" class="column-search srno-search" data-column="0"></th>
                                <th><input type="text" class="column-search Pi-no-search" data-column="1"></th>
                                <th><input type="text" class="column-search OCF_No-search" data-column="2"></th>
                                <th><input type="text" class="column-search  Invoice_No-search" data-column="3"></th>
                                <th><input type="text" class="column-search PI_Date-search" data-column="4"></th>
                                <th><input type="text" class="column-search CustomerName-search" data-column="5"></th>
                                <th><input type="text" class="column-search Commission_Vendor_Name-search" data-column="6"></th>
                                <th><input type="text" class="column-search CommissionType-search" data-column="7"></th>
                                <th><input type="text" class="column-search CommissionRate-search" data-column="8"></th>
                                <th><input type="text" class="column-search SalesPerson_Name-search" data-column="9"></th>
                                <th><input type="text" class="column-search TaggedOnPI-search" data-column="10"></th>
                                <th><input type="text" class="column-search TaggedOnOCF-search" data-column="11"></th>
                                <th><input type="text" class="column-search TaggedOnINV-serch" data-column="12"></th>
                            </tr>
                        </thead>
                        <tbody class="Infotbody"></tbody>
                    </table>-->
                    <!-- End Table with stripped rows -->
                    <!--</div>
            </div>
        </div>
    </div>-->
                    <div id="tabList" class="tab-pane active">
                        <div class="box">
                            <div class="col-md-12 form-group" id="invoiceNoSearchSectionList" style="margin-top: 6px !important; ">
                                <label for="Searchtype">@resourceSettings.getResourceLable("lblSearchType", "common", "Search Type")</label>
                                @Html.DropDownListFor(model => model.SearchType, new SelectList(ViewBag.SearchTypes, "Value", "Text"), new { @class = "form-control", onchange = "GetData()", @id = "searchType", style = "width: 100px;" })

                                <label for="invoiceNoSearch">@resourceSettings.getResourceLable("lblInvoiceNo", "common", "Invoice No")</label>
                                @Html.TextBoxFor(model => model.Invoice_No, new { @class = "form-control", @id = "invoiceNoSearch", style = "width: 150px;" })
                                <a href="" id="lnkSave" class="btn-cancel">
                                    <i class="fa fa-eraser"></i>
                                    @resourceSettings.getResourceLable("lblSerch", "common", "Serch")
                                </a>
                                <a href="" id="lnkAll" class="btn-cancel">
                                    <i class="fa fa-eraser"></i>
                                    @resourceSettings.getResourceLable("lblALL", "common", "ALL")
                                </a>

                                <div id="commissionpage" style=" margin-top: -17px; margin-left: 104rem; text-align: end;"></div>
                            </div>

                            <div class="clearfix"></div>
                            <div class="form-group"></div>
                            <div class="box-body">
                                <div class="col-md-12 form-group" style="margin-left: -13px !important; margin-top: -29px !important ">
                                    <div class="table-responsive">

                                        <div id="loadingMessage1" style="text-align:center; padding:20px; font-size:16px; display:none;">
                                            <span><i class="fa fa-spinner fa-spin" style="font-size:100px"></i> Loading data, please wait...</span>
                                        </div>

                                        <table id="TblcommissionInfo" class="table table-bordered table-striped mt-4">
                                            <thead style="text-align:center!important;">

                                                <tr style="text-align:center!important;" class="coma">
                                                    <th style="text-align: center;">Sr No</th>
                                                    <th title="PI No"><b>PI No</b></th>
                                                    <th title="OCF No">OCF No</th>
                                                    <th title="InvoiceNo">InvoiceNo</th>
                                                    <th title="InvDate"><b>InvDate</b></th>
                                                    <th title="Customer Name">Customer Name</th>
                                                    <th title="Commission Vendor Name">Commission Vendor<br />Name</th>
                                                    <th title="Commission Type"><b>Commission Type</b></th>
                                                    <th title="Commission Rate">Commission Rate</th>
                                                    <th title="Sales Person Name">Sales Person<br />Name</th>
                                                    <th title="Tentative Commission Basic Amt">Tentative Commission <br />Basic Amt</th>
                                                    <th title="ActualCommission">ActualCommission</th>
                                                    <th title="Commission Working Sent To Vendor ">Commission Working<br />Sent To Vendor</th>
                                                    <th title="Commission Invoice Recieved">Commission Invoice<br />Recieved</th>
                                                    <th title="Claim From Received"><b>Claim From<br />Received</b></th>
                                                    <th title="Credit Advice Prepared"><b>Credit Advice Prepared</b></th>
                                                    <th title="Credit Advice Details"><b>Credit Advice<br />Details</b></th>
                                                    <th title="Credit Note No"><b>Credit Note<br /> No</b></th>
                                                    <th title="Credit_Note_Prepared"><b>Credit Note<br />Prepared</b></th>
                                                    <th title="Tagged ON PI"><b>Tagged ON<br />PI</b></th>
                                                    <th title="Tagged On OCF">Tagged On<br />OCF</th>
                                                    <th title="Tagged After Invoice"><b>Tagged After<br />Invoice</b></th>
                                                    <th title="Vendor Code">Vendor Code</th>
                                                </tr>
                                                <tr class="comb">
                                                    <th><input type="text" class="column-search srno-search" data-column="0"></th>
                                                    <th><input type="text" class="column-search Pi-no-search" data-column="1"></th>
                                                    <th><input type="text" class="column-search OCF_No-search" data-column="2"></th>
                                                    <th><input type="text" class="column-search Invoice_No-search" data-column="3"></th>
                                                    <th><input type="text" class="column-search Invoice_Date-search" data-column="4"></th>
                                                    <th><input type="text" class="column-search CustomerName-search" data-column="5"></th>
                                                    <th><input type="text" class="column-search Commission_Vendor_Name-search" data-column="6"></th>
                                                    <th><input type="text" class="column-search CommissionType-search" data-column="7"></th>
                                                    <th><input type="text" class="column-search CommissionRate-search" data-column="8"></th>
                                                    <th><input type="text" class="column-search SalesPerson_Name-search" data-column="9"></th>
                                                    <th><input type="text" class="column-search Tentative-comm-basic-amt-search" data-column="10"></th>
                                                    <th><input type="text" class="column-search ActualCommission-search" data-column="11"></th>
                                                    <th><input type="text" class="column-search Commission_Working_sent_Vendor_Employee-search" data-column="12"></th>
                                                    <th><input type="text" class="column-search Commission-invoice-received-search" data-column="13"></th>
                                                    <th><input type="text" class="column-search Claim-from-received-search" data-column="14"></th>
                                                    <th><input type="text" class="column-search Credit-Advice_Details-search" data-column="15"></th>
                                                    <th><input type="text" class="column-search Credit-note_prepared-search" data-column="16" style=" width: 72px;"></th>
                                                    <th><input type="text" class="column-search Credit-note_prepared-search" data-column="17" style=" width: 72px;"></th>
                                                    <th><input type="text" class="column-search TaggedOnPI-search" data-column="18"></th>
                                                    <th><input type="text" class="column-search TaggedOnOCF-search" data-column="19"></th>
                                                    <th><input type="text" class="column-search Tagged-after-invoice-search" data-column="20"></th>
                                                    <th><input type="text" class="column-search Vendor-name-search" data-column="21"></th>
                                                    <th><input type="text" class="column-search Vendor-name-search" data-column="22"></th>
                                                </tr>
                                            </thead>
                                            <tbody class="commissionInfotbody"></tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div id="tabDetail" class="HeaderFont tab-pane">
                        <div class="form-group"></div>
                        <div class="card" style="margin-top: 1rem; margin-bottom: -3px; border: 1px solid blanchedalmond; width: 98%; margin-left: 2rem; height: 73rem;">
                            <div class="card-body" style="margin-top: 2rem; margin-bottom: 0rem;">
                                <div class="card" style="border: 1px solid blanchedalmond; width: 98%; margin-left: 29px;">
                                    <div class="card-body" style="margin-top: 2rem; margin-bottom: 0rem;">
                                        <div class="col-md-12 form-group">
                                            <div class="col-md-4">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">PI No</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.PI_No, new { Class = "form-control ", @disabled = "disabled" })</div>



                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Customer Name</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.CustomerName, new { Class = "form-control ", maxlength = "500" , @disabled = "disabled" })</div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Commission Rate</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.CommissionRate, new { Class = "form-control" , @disabled = "disabled" })</div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">OCF No</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.OCF_No, new { Class = "form-control " , @disabled = "disabled" })</div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Vendor Name</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.Commission_Vendor_Name, new { Class = "form-control", @disabled = "disabled" })</div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Tentative Amount</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.TentativeCommBasic_Amt, new { Class = "form-control", @disabled = "disabled" })</div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Invoice No</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.Invoice_No, new { Class = "form-control ", maxlength = "500" , @disabled = "disabled" })</div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Date</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.INV_Dates, new { Class = "form-control", placeholder = "dd/mm/yy", maxlength = "500", @disabled = "disabled" })</div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Commission Type</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.CommissionType, new { Class = "form-control", maxlength = "500" , @disabled = "disabled" })</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12 form-group ">
                                            <div class="col-md-4">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Sales Person Name</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.SalesPerson_Name, new { Class = "form-control", maxlength = "500",@disabled = "disabled" })</div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Actual Commission</div>
                                                    <div class="col-md-6">@Html.TextBoxFor(model => model.ActualCommission, new { Class = "form-control", @disabled = "disabled" })</div>
                                                </div>
                                               
                                            </div>
                                            <div class="col-md-4">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Tagged ON PI</div>
                                                    <div class="col-md-6">
                                                        @Html.CheckBoxFor(m => m.TaggedOnPI, new { @checked = "checked", @disabled = "disabled" }) Yes


                                                    </div>
                                                </div>
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Tagged After InVoice</div>
                                                    <div class="col-md-6">
                                                        @Html.CheckBoxFor(m => m.TaggedAfterInvoice, new { @checked = "checked", @disabled = "disabled" }) Yes

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">Tagged On ERP</div>
                                                    <div class="col-md-6">
                                                        @Html.CheckBoxFor(m => m.TaggedOnOCF, new { @checked = "checked" , @disabled = "disabled" }) Yes

                                                    </div>
                                                </div>
                                               
                                            </div>
                                            <div class="col-md-4" style="display:none">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">From No</div>
                                                    <div class="col-md-6">
                                                        @Html.TextBoxFor(model => model.FromNo, new { Class = "form-control" })

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4" style="display:none">
                                                <div class="col-md-12 form-group">
                                                    <div class="col-md-4 PDtop6px FontSize">VendorNo</div>
                                                    <div class="col-md-6">
                                                        @Html.TextBoxFor(model => model.Vendor_Code, new { Class = "form-control" })

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="col-md-12 form-group" style="">
                                    <div class="col-md-4 form-group">
                                        <div class="card" style="margin-top: 0rem; margin-bottom: -4px; border: 1px solid blanchedalmond; width: 101%; ">
                                            <div class="card-body" style="margin-top: 2rem; margin-bottom: 0rem;">
                                                <!-- Factory / HO Section -->

                                                <h5 class="FontSizeTh">1. Pre Marketing</h5>
                                                <br /><br />
                                                <table class="table brodertb">
                                                    <tr>
                                                        <th><div class="col-md-12 FontSize">Claim From Received</div></th>
                                                        <th>
                                                            <div class="col-md-12">
                                                                @Html.TextBoxFor(model => model.Claimform_Received, new { Class = "form-control", placeholder = "dd/mm/yy" })

                                                            </div>
                                                        </th>
                                                    </tr>

                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-4 form-group">
                                        <div class="card" style="margin-top: 0rem; margin-bottom: -4px; border: 1px solid blanchedalmond; width: 101%;">
                                            <div class="card-body" style="margin-top: 2rem; margin-bottom: 0rem;">
                                                <!-- Commercial Section -->

                                                <h5 class="FontSizeTh">2. Commercial</h5>
                                                <br /><br />
                                                <table class="table brodertb">
                                                    <tr>
                                                        <th><div class="col-md-12 FontSize">Commission Working Sent To Vendor</div></th>
                                                        <th>
                                                            <div class="col-md-12">
                                                                @Html.TextBoxFor(model => model.CommissionworkingsenttoVendor_Employee, new { Class = "form-control", placeholder = "dd/mm/yy" })

                                                            </div>
                                                    </tr>

                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-4 form-group">
                                        <div class="card" style="margin-top: 0rem; margin-bottom: -4px; border: 1px solid blanchedalmond; width: 102%;">
                                            <div class="card-body" style="margin-top: 2rem; margin-bottom: 0rem;">
                                                @*HOD Approval Section*@

                                                <h5 class="FontSizeTh">3. Post Marketing</h5>
                                                <br /><br />
                                                <table class="table brodertb">
                                                    <tr>
                                                        <th><div class="col-md-12 FontSize">Commission Invoice Received</div></th>
                                                        <th>
                                                            <div class="col-md-12">
                                                                @Html.TextBoxFor(model => model.CommissionInvoice_Received, new { Class = "form-control", placeholder = "dd/mm/yy" })

                                                            </div>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-md-12 form-group">

                                    <!-- Logistics -->
                                    <div class="col-md-4 form-group">
                                        <div class="card h-100" style="border: 1px solid blanchedalmond;">
                                            <div class="card-body d-flex flex-column" style="padding-top: 2rem;">
                                                <h5 class="FontSizeTh">4. Logistics</h5>
                                                <br />
                                                <table class="table brodertb">
                                                    <tr>
                                                        <th><div class="col-md-12 FontSize">Credit Advice Prepared</div></th>
                                                        <th>
                                                            <div class="col-md-12">
                                                                @Html.TextBoxFor(model => model.Credit_Advice_Prepared, new { @class = "form-control", placeholder = "dd/mm/yy" })
                                                            </div>
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th><div class="col-md-12 FontSize">Credit Advice Details</div></th>
                                                        <th>
                                                            <div class="col-md-12">
                                                                @Html.TextBoxFor(model => model.Credit_Advice_Details, new { @class = "form-control", maxlength = "500" })
                                                            </div>
                                                        </th>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Accounts -->
                                    <div class="col-md-4 form-group">
                                        <div class="card h-100" style="border: 1px solid blanchedalmond;">
                                            <div class="card-body d-flex flex-column" style="padding-top: 2rem;">
                                                <h5 class="FontSizeTh">5. Accounts</h5>
                                                <br />
                                                <table class="table brodertb">
                                                    <tr>
                                                        <th><div class="col-md-12 FontSize">Credit Note No</div></th>
                                                        <th>
                                                            <div class="col-md-12">
                                                                @Html.TextBoxFor(model => model.CreditNotePreparedNo, new { @class = "form-control" })
                                                            </div>
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th><div class="col-md-12 FontSize">Credit Note Prepared</div></th>
                                                        <th>
                                                            <div class="col-md-12">
                                                                @Html.TextBoxFor(model => model.Credit_Note_Prepared, new { @class = "form-control", placeholder = "dd/mm/yy" })
                                                            </div>
                                                        </th>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4"></div>
                                </div>


                                <div class="col-md-12 form-group" style="margin-top:-3rem ;margin-left: 2rem !important;">

                                    <div class="col-md-6">
                                        <a href="javascript:void(0)" id="lnkSaveDetails" class="btn-cancel me-2">
                                            <i class="fa fa-eraser"></i> @resourceSettings.getResourceLable("lblSave", "common", "Save")
                                        </a>
                                        <a href="javascript:void(0)" id="lnkRefreshDetails" class="btn-cancel me-2" style=" width: 94px;">
                                            <i class="fa fa-eraser"></i> @resourceSettings.getResourceLable("lblRefresh", "common", "Refresh")
                                        </a>
                                        <a href="javascript:void(0)" id="lnkDeleteRecore" class="btn-cancel me-2">
                                            <i class="fa fa-eraser"></i> @resourceSettings.getResourceLable("lblDelete", "common", "Delete")
                                        </a>
                                        <a href="javascript:void(0)" id="lnkExitDetails" class="btn-cancel">
                                            <i class="fa fa-eraser"></i> @resourceSettings.getResourceLable("lblExit", "common", "Exit")
                                        </a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div id="tabPreMar" class="tab-pane">
                        <div class="box">
                            @* <div class="col-md-12 form-group"  style="margin-top: -1rem; margin-left: 45rem; ">*@
                            <div class="col-md-12 form-group" id="invoiceNoSearchSectionpre" style=" ">

                                <label for="invoiceNoSearch">@resourceSettings.getResourceLable("lblInvoiceNo", "common", "Invoice No")</label>
                                @Html.TextBoxFor(model => model.Invoice_No, new { @class = "form-control", @id = "invoiceNoSearch", style = "width: 150px;" })
                                <label for="invoiceDateSearch">@resourceSettings.getResourceLable("lblInvoiceDate", "common", "Invoice Date")</label>
                                @Html.TextBoxFor(model => model.INV_Dates, new { @class = "form-control", @id = "invoiceDateSearch", style = "width: 150px;" })
                                <a href="" id="lnkPremarkSerch" class="btn-cancel">
                                    <i class="fa fa-eraser"></i>
                                    @resourceSettings.getResourceLable("lblSerch", "common", "Serch")
                                </a>
                                <a href="" id="lnkClear" class="btn-cancel">
                                    <i class="fa fa-eraser"></i>
                                    @resourceSettings.getResourceLable("lblClear", "common", "Clear")
                                </a>

                                <div id="lengthSelectorWrapper" style="margin-top: -17px; margin-left: 103rem; text-align: end;"></div>
                            </div>
                            <div class="box-body">
                                <div class="table-responsive">
                                    <div id="loadingMessage2" style="text-align:center; padding:20px; font-size:16px; display:none;">
                                        <span><i class="fa fa-spinner fa-spin" style="font-size:100px"></i> Loading data, please wait...</span>
                                    </div>
                                    <table id="TblPreMarketingInfo" class="table table-bordered table-striped mt-0" style=" margin-top: 0px !important;">
                                        <thead>
                                            <tr style="text-align:center;">
                                                <th class="HeaderFont" style="text-align: center;">Sr No</th>
                                                <th class="HeaderFont" title="PI No"><b>PI No</b></th>
                                                <th class="HeaderFont" title="OCF No">OCF No</th>
                                                <th class="HeaderFont" title="Invoice No">Invoice No</th>
                                                <th class="HeaderFont" title="Invoice Date">INV Date</th>
                                                <th class="HeaderFont" title="Customer Name">Customer Name</th>
                                                <th class="HeaderFont" title="Commission Vendor Name">Commission Vendor<br />Name</th>
                                                <th class="HeaderFont" title="Commission Type"><b>Commission Type</b></th>
                                                <th class="HeaderFont" title="Sales Person Name">Sales Person<br />Name</th>
                                                <th class="HeaderFont" title="Commission Rate">Commission Rate</th>
                                                <th title="Tentative Commission Basic Amt">Tentative Commission<br />Basic Amt</th>
                                                <th class="HeaderFont" title="Tagged ON PI"><b>Tagged ON<br />PI</b></th>
                                                <th class="HeaderFont" title="Tagged On OCF">Tagged On<br />OCF</th>
                                                <th title="Tagged After Invoice"><b>Tagged After<br />Invoice</b></th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Select All">Select All</th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Claim From Received"><b>Claim From<br />Received</b></th>
                                                <th class="HeaderFont" title="From No" style="display:none"><b>Frome No</b></th>
                                                <th class="HeaderFont" title="Vendor code" style="display:none"><b>Vendor code</b></th>

                                            </tr>
                                            <tr>
                                                <th><input type="text" class="column-search srno-search" data-column="0"></th>
                                                <th><input type="text" class="column-search Pi-no-search" data-column="1"></th>
                                                <th><input type="text" class="column-search OCF_No-search" data-column="2"></th>
                                                <th><input type="text" class="column-search Invoice_No-search" data-column="3"></th>
                                                <th><input type="text" class="column-search Invoice_Date-search" data-column="4"></th>
                                                <th><input type="text" class="column-search CustomerName-search" data-column="5"></th>
                                                <th><input type="text" class="column-search Commission_Vendor_Name-search" data-column="6"></th>
                                                <th><input type="text" class="column-search CommissionType-search" data-column="7"></th>
                                                <th><input type="text" class="column-search SalesPerson_Name-search" data-column="8"></th>
                                                <th><input type="text" class="column-search CommissionRate-search" data-column="9"></th>
                                                <th><input type="text" class="column-search Tentative-comm-basic-amt-search" data-column="10"></th>
                                                <th><input type="text" class="column-search TaggedOnPI-search" data-column="11"></th>
                                                <th><input type="text" class="column-search TaggedOnOCF-search" data-column="12"></th>
                                                <th><input type="text" class="column-search Tagged-after-invoice-search" data-column="13"></th>
                                                <th><input type="text" class="column-search selectAll-serch" data-column="14"></th>
                                                <th><input type="text" class="column-search Claim-from-received-search" data-column="15"></th>
                                                <th style="display:none"><input type="text" class="column-search" data-column="16"></th>
                                                <th style="display:none"><input type="text" class="column-search" data-column="17"></th>

                                            </tr>
                                        </thead>
                                        <tbody class="PreMarketingInfotbody"></tbody>
                                    </table>
                                    <div class="col-md-6" id="rowdspre" style=" display: flex; margin-top: -4rem; margin-left: 99rem; ">
                                        <div style="width: 16px; height: 16px; background-color: lightgreen; border: 1px solid #000; margin-right: 8px;"></div>
                                        <b style="font-weight: bold;">Green Color Column Modify Only</b>

                                        @* <div class="col-md-1"  style=" margin-top: -3rem !important; margin-left: 49rem; ">
                                @Html.CheckBoxFor(model => model.emty, new { styles = "margin-left: -14px;", @disabled = "disabled", @class = "green-checkbox" })    <b style="font-weight: bold;">Green Color Column Modify Only</b>
                            </div>*@
                                        @Html.CheckBoxFor(model => model.SelectPreMarketing, new { @id = "SelectPreMarketing" })    <b style="font-weight: bold;">Select ALL</b>

                                        <label for="invoiceNoSearch" style="">@resourceSettings.getResourceLable("lblClaim_Form_Received", "common", "Claim Form Received")</label>
                                        @Html.TextBoxFor(model => model.Claimform_Received, new { @class = "form-control", @id = "Claim_form_DatepreMar", onclick = "showDate(this);", style = "width: 150px;" })

                                        <a href="" id="lnkUpdatePremarketing" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblUpdate", "common", "Update")</a>
                                        <a href="" id="lnkPremarrefresh" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblRefresh", "common", "Refresh")</a>

                                    </div>

                                    <!-- End Table with stripped rows -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="tabCommercial" class="tab-pane">
                        <div class="box">
                            <div id="commercialpage" style=" margin-top: 8px; text-align: end; margin-right: 1rem;"></div>
                            <div class="box-body">
                                <div class="table-responsive">
                                    <div id="loadingMessage3" style="text-align:center; padding:20px; font-size:16px; display:none;">
                                        <span><i class="fa fa-spinner fa-spin" style="font-size:100px"></i> Loading data, please wait...</span>
                                    </div>
                                    <table id="TblCommercialInfo" class="table table-bordered table-striped mt-4">
                                        <thead>
                                            <tr style="text-align:center">
                                                <th class="HeaderFont" style="text-align: center;">Sr No</th>
                                                <th class="HeaderFont" title="PI No"><b>PI No</b></th>
                                                <th class="HeaderFont" title="OCF No">OCF No</th>
                                                <th class="HeaderFont" title="Invoice No">Invoice No</th>
                                                <th class="HeaderFont" title="INV Date"><b>INV Date</b></th>
                                                <th class="HeaderFont" title="Customer Name">Customer Name</th>
                                                <th class="HeaderFont" title="Commission Vendor Name">Commission Vendor<br />Name</th>
                                                <th class="HeaderFont" title="Commission Type"><b>Commission Type</b></th>
                                                <th class="HeaderFont" title="Sales Person Name">Sales Person<br />Name</th>
                                                <th class="HeaderFont" title="Commission Rate">Commission Rate</th>
                                                <th title="Tentative Commission Basic Amt">Tentative Commission<br />Basic Amt</th>
                                                <th class="HeaderFont" title="ActualCommission" style="background-color: lightgreen; "><b>ActualCommission</b></th>
                                                <th class="HeaderFont" title="Tagged ON PI"><b>Tagged ON<br />PI</b></th>
                                                <th class="HeaderFont" title="Tagged On OCF">Tagged On<br />OCF</th>
                                                <th title="Tagged After Invoice"><b>Tagged After</b>Invoice</th>
                                                <th class="HeaderFont" title="Claim From Received"><b>Claim From<br />Received</b></th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Select All">Select All</th>
                                                <th title="Commission Working Sent To Vendor" style="background-color: lightgreen; ">Commission Working<br />Sent To Vendor</th>
                                                <th class="HeaderFont" title="Remarks" style="background-color: lightgreen; ">Remarks</th>
                                                @*<th class="HeaderFont" title="Freight Amt">Freight Amt</th>
                                                <th class="HeaderFont" title="Freight Bill No">Freight Bill<br />No</th>
                                                <th class="HeaderFont" title="Freight Bill Date">Freight Bill<br /> Date</th>*@
                                                <th class="HeaderFont" title="From No" style="display:none"><b>Frome No</b></th>
                                                <th class="HeaderFont" title="Vendor code" style="display:none"><b>Vendor code</b></th>

                                            </tr>
                                            <tr>
                                                <th><input type="text" class="column-search srno-search" data-column="0"></th>
                                                <th><input type="text" class="column-search Pi-no-search" data-column="1"></th>
                                                <th><input type="text" class="column-search OCF_No-search" data-column="2"></th>
                                                <th><input type="text" class="column-search Invoice_No-search" data-column="3"></th>
                                                <th><input type="text" class="column-search Invoice_Date-search" data-column="4"></th>
                                                <th><input type="text" class="column-search CustomerName-search" data-column="5"></th>
                                                <th><input type="text" class="column-search Commission_Vendor_Name-search" data-column="6"></th>
                                                <th><input type="text" class="column-search CommissionType-search" data-column="7"></th>
                                                <th><input type="text" class="column-search SalesPerson_Name-search" data-column="8"></th>
                                                <th><input type="text" class="column-search CommissionRate-search" data-column="9"></th>
                                                <th><input type="text" class="column-search Tentative-comm-basic-amt-search" data-column="10"></th>
                                                <th><input type="text" class="column-search ActualCommission-search" data-column="11"></th>
                                                <th><input type="text" class="column-search TaggedOnPI-search" data-column="12"></th>
                                                <th><input type="text" class="column-search TaggedOnOCF-search" data-column="13"></th>
                                                <th><input type="text" class="column-search Tagged-after-invoice-search" data-column="14"></th>
                                                <th><input type="text" class="column-search Claim-from-received-search" data-column="15"></th>
                                                <th><input type="text" class="column-search selectAll-serch" data-column="16"></th>
                                                <th><input type="text" class="column-search Commission_Working_sent_Vendor_Employee-search" data-column="17"></th>
                                                <th><input type="text" class="column-search Remarks-search" data-column="18"></th>
                                                @*<th><input type="text" class="column-search freight_amt-search" data-column="19"></th>
                                                <th><input type="text" class="column-search freight-bill-no-search" data-column="20"></th>
                                                <th><input type="text" class="column-search freight-bill-date-serch" data-column="21"></th>*@
                                                <th style="display:none"><input type="text" class="column-search" data-column="22"></th>
                                                <th style="display:none"><input type="text" class="column-search" data-column="23"></th>


                                            </tr>
                                        </thead>
                                        <tbody class="CommercialInfotbody"></tbody>
                                    </table>

                                    <div class="col-md-12 form-group" id="Commercialf" display: flex; margin-top: -4rem; margin-left: 99rem;>
                                        <div style="width: 16px; height: 16px; background-color: lightgreen; border: 1px solid #000; margin-right: 8px;"></div>
                                        <b style="font-weight: bold;">Green Color Column Modify Only</b>
                                        @Html.CheckBoxFor(model => model.SelectCommercial, new { styles = "margin-left: -14px;", @id = "SelectCommercial" })     <b style="font-weight: bold;">Select ALL</b>

                                        <label for="ActualCommission" style="">@resourceSettings.getResourceLable("lblActualCommission", "common", "ActualCommission")</label>
                                        @Html.TextBoxFor(model => model.ActualCommission, new { @class = "form-control ActualCommission", style = "width: 150px;", id = "txtActualCommision" })
                                        <label for="CommissionworkingsenttoVendor_Employee">@resourceSettings.getResourceLable("lblCommission_working_sent_tovendor", "common", "Commission Working To Vendor")</label>
                                        @Html.TextBoxFor(model => model.CommissionworkingsenttoVendor_Employee, new { @class = "form-control", onclick = "showDate(this);", @id = "Commission_working_DatePost", style = "width: 150px;" })
                                        <label for="Remarks" style="">@resourceSettings.getResourceLable("lblRemarks", "common", "Remarks")</label>
                                        @Html.TextBoxFor(model => model.Remarks, new { @class = "form-control", @id = "Remarks", style = "width: 150px;" })

                                        <a href="" id="lnkUpdateCommercial" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblUpdate", "common", "Update")</a>
                                        <a href="" id="lnkCommercialRefresh" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblRefresh", "common", "Refresh")</a>

                                    </div>


                                    @*End Table with stripped rows*@
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="tabPostMarketing" class="tab-pane">
                        <div class="box">
                            <div id="Postpage" style=" margin-top: 8px; text-align: end; margin-right: 1rem;"></div>
                            <div class="box-body">
                                <div class="table-responsive">
                                    <div id="loadingMessage4" style="text-align:center; padding:20px; font-size:16px; display:none;">
                                        <span><i class="fa fa-spinner fa-spin" style="font-size:100px"></i> Loading data, please wait...</span>
                                    </div>
                                    <table id="TblPostMarketingInfo" class="table table-bordered table-striped mt-4" style=" margin-top: 3px !important;">
                                        <thead>
                                            <tr style="text-align: center;">
                                                <th class="HeaderFont" style="text-align: center;">Sr No</th>
                                                <th class="HeaderFont" title="PI No"><b>PI No</b></th>
                                                <th class="HeaderFont" title="OCF No">OCF No</th>
                                                <th class="HeaderFont" title="Invoice No">Invoice No</th>
                                                <th class="HeaderFont" title="INV Date"><b>INV Date</b></th>
                                                <th class="HeaderFont" title="Customer Name">Customer Name</th>
                                                <th class="HeaderFont" title="Commission_Vendor_Name">Commission Vendor<br />Name</th>
                                                <th class="HeaderFont" title="Commission Type"><b>Commission Type</b></th>
                                                <th class="HeaderFont" title="Sales Person Name">Sales Person<br />Name</th>
                                                <th class="HeaderFont" title="Commission Rate">Commission Rate</th>
                                                <th title="Tentative Commission Basic Amt">Tentative Commission<br />Basic Amt</th>
                                                <th class="HeaderFont" title="ActualCommission"><b>ActualCommission</b></th>
                                                <th class="HeaderFont" title="Tagged ON PI"><b>Tagged ON<br />PI</b></th>
                                                <th class="HeaderFont" title="Tagged On OCF">Tagged On<br />OCF</th>
                                                <th title="Tagged After Invoice"><b>Tagged After<br />Invoice</b></th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Claim From Received"><b>Claim From</b>Received</th>
                                                <th title="Commission Working Sent To Vendor">Commission Working<br />Sent To Vendor</th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Select All">Select All</th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Commission Invoice Received">Commission Invoice<br />Received</th>
                                                <th class="HeaderFont" title="From No" style="display:none"><b>Frome No</b></th>
                                                <th class="HeaderFont" title="Vendor code" style="display:none"><b>Vendor code</b></th>
                                            </tr>
                                            <tr>
                                                <th><input type="text" class="column-search srno-search" data-column="0"></th>
                                                <th><input type="text" class="column-search Pi-no-search" data-column="1"></th>
                                                <th><input type="text" class="column-search OCF_No-search" data-column="2"></th>
                                                <th><input type="text" class="column-search Invoice_No-search" data-column="3"></th>
                                                <th><input type="text" class="column-search Invoice_Date-search" data-column="4"></th>
                                                <th><input type="text" class="column-search CustomerName-search" data-column="5"></th>
                                                <th><input type="text" class="column-search Commission_Vendor_Name-search" data-column="6"></th>
                                                <th><input type="text" class="column-search CommissionType-search" data-column="7"></th>
                                                <th><input type="text" class="column-search SalesPerson_Name-search" data-column="8"></th>
                                                <th><input type="text" class="column-search CommissionRate-search" data-column="9"></th>
                                                <th><input type="text" class="column-search Tentative-comm-basic-amt-search" data-column="10"></th>
                                                <th><input type="text" class="column-search ActualCommission-search" data-column="11"></th>
                                                <th><input type="text" class="column-search TaggedOnPI-search" data-column="12"></th>
                                                <th><input type="text" class="column-search TaggedOnOCF-search" data-column="13"></th>
                                                <th><input type="text" class="column-search Tagged-after-invoice-search" data-column="14"></th>
                                                <th><input type="text" class="column-search Claim-from-received-search" data-column="15"></th>
                                                <th><input type="text" class="column-search Commission_Working_sent_Vendor_Employee-search" data-column="16"></th>
                                                <th><input type="text" class="column-search selectAll-serch" data-column="17"></th>
                                                <th><input type="text" class="column-search Commission-invoice-received-search" data-column="18"></th>
                                                <th style="display:none"><input type="text" class="column-search" data-column="19"></th>
                                                <th style="display:none"><input type="text" class="column-search" data-column="20"></th>
                                            </tr>
                                        </thead>
                                        <tbody class="PostMarketingInfotbody"></tbody>
                                    </table>
                                    <div class="col-md-9 form-group" id="postp" style=" white-space: nowrap; margin-top: -4rem; margin-left: 61rem; ">

                                        <div style="width: 16px; height: 16px; background-color: lightgreen; border: 1px solid #000;"></div>
                                        <b style="font-weight: bold;">Green Color Column Modify Only</b>
                                        @Html.CheckBoxFor(model => model.SelectPostMarketing, new { @id = "SelectPostMarketing" }) Select ALL
                                        <label for="Claimform_Received">@resourceSettings.getResourceLable("lblClaim_Form_Received", "common", "Claim Form Received")</label>
                                        @Html.TextBoxFor(model => model.Claimform_Received, new { @class = "form-control", @id = "Claimform_ReceivedDate", onclick = "showDate(this);", onfocus = "showDate(this);", style = "width: 150px;" })
                                        @*<a href="" id="lnkUpdatePost" class="btn-cancel" ><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblUpdate", "common", "Update")</a>
                                        *@ <label for="CommissionInvoice_Received">@resourceSettings.getResourceLable("lblCommission_invoice_Received", "common", "Commission Invoice Received")</label>
                                        @Html.TextBoxFor(model => model.CommissionInvoice_Received, new { @class = "form-control", onclick = "showDate(this);", onfocus = "showDate(this);", @id = "CommissionInvoiceReceivedPost", style = "width: 150px;" })
                                        <a href="" id="lnkUpdatePostMarketing" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblUpdate", "common", "Update")</a>
                                        <a href="" id="lnkPostMarketingRefresh" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblRefresh", "common", "Refresh")</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="tabLogistics" class="tab-pane">
                        <div class="box">
                            <div id="Logpage" style=" margin-top: 8px; text-align: end; margin-right: 1rem;"></div>

                            <div class="box-body">
                                <div class="table-responsive">
                                    <div id="loadingMessage5" style="text-align:center; padding:20px; font-size:16px; display:none;">
                                        <span><i class="fa fa-spinner fa-spin" style="font-size:100px"></i> Loading data, please wait...</span>
                                    </div>
                                    <table id="TblLogisticsInfo" class="table table-bordered table-striped mt-4" style=" margin-top: 3px !important;">
                                        <thead>
                                            <tr style="text-align: center;">
                                                <th class="HeaderFont" style="text-align: center;">Sr No</th>
                                                <th class="HeaderFont" title="PI No"><b>PI No</b></th>
                                                <th class="HeaderFont" title="OCF No">OCF No</th>
                                                <th class="HeaderFont" title="InvoiceNo">InvoiceNo</th>
                                                <th class="HeaderFont" title="InvDate"><b>InvDate</b></th>
                                                <th class="HeaderFont" title="Customer Name">Customer Name</th>
                                                <th class="HeaderFont" title="Commission Vendor Name">Commission Vendor<br />Name</th>
                                                <th class="HeaderFont" title="Commission Type"><b>Commission Type</b></th>
                                                <th class="HeaderFont" title="Sales Person Name">Sales Person<br />Name</th>
                                                <th class="HeaderFont" title="Commission Rate">Commission Rate</th>
                                                <th title="Tentative Commission Basic Amt">Tentative Commission<br />Basic Amt</th>
                                                <th class="HeaderFont" title="ActualCommission"><b>ActualCommission</b></th>
                                                <th class="HeaderFont" title="Tagged ON PI"><b>Tagged ON<br />PI</b></th>
                                                <th class="HeaderFont" title="Tagged On OCF">Tagged On<br />OCF</th>
                                                <th title="Tagged After Invoice"><b>Tagged After<br />Invoice</b></th>
                                                <th class="HeaderFont" title="Claim From Received"><b>Claim From<br />Received</b></th>
                                                <th title="Commission Working Sent To Vendor">Commission Working<br />Sent To Vendor</th>
                                                <th title="Commission Invoice Received">Commission Invoice<br />Received</th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Select All">Select All</th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Credit Advice Prepared"><b>Credit Advice<br />Prepared</b></th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Credit Advice Details"><b>Credit Advice<br />Details</b></th>
                                                <th class="HeaderFont" title="From No" style="display:none"><b>Frome No</b></th>
                                                <th class="HeaderFont" title="Vendor code" style="display:none"><b>Vendor code</b></th>
                                            </tr>
                                            <tr>
                                                <th><input type="text" class="column-search srno-search" data-column="0"></th>
                                                <th><input type="text" class="column-search Pi-no-search" data-column="1"></th>
                                                <th><input type="text" class="column-search OCF_No-search" data-column="2"></th>
                                                <th><input type="text" class="column-search Invoice_No-search" data-column="3"></th>
                                                <th><input type="text" class="column-search Invoice_Date-search" data-column="4"></th>
                                                <th><input type="text" class="column-search CustomerName-search" data-column="5"></th>
                                                <th><input type="text" class="column-search Commission_Vendor_Name-search" data-column="6"></th>
                                                <th><input type="text" class="column-search CommissionType-search" data-column="7"></th>
                                                <th><input type="text" class="column-search SalesPerson_Name-search" data-column="8"></th>
                                                <th><input type="text" class="column-search CommissionRate-search" data-column="9"></th>
                                                <th><input type="text" class="column-search Tentative-comm-basic-amt-search" data-column="10"></th>
                                                <th><input type="text" class="column-search ActualCommission-search" data-column="11"></th>
                                                <th><input type="text" class="column-search TaggedOnPI-search" data-column="12"></th>
                                                <th><input type="text" class="column-search TaggedOnOCF-search" data-column="13"></th>
                                                <th><input type="text" class="column-search Tagged-after-invoice-search" data-column="14"></th>
                                                <th><input type="text" class="column-search Claim-from-received-search" data-column="15"></th>
                                                <th><input type="text" class="column-search Commission_Working_sent_Vendor_Employee-search" data-column="16"></th>
                                                <th><input type="text" class="column-search Commission-invoice-received-search" data-column="17"></th>
                                                <th><input type="text" class="column-search selectAll-serch" data-column="18"></th>
                                                <th><input type="text" class="column-search Credit-Advice-Prepared-search" data-column="19"></th>
                                                <th><input type="text" class="column-search Credit-Advice_Details-search" data-column="20"></th>
                                                <th style="display:none"><input type="text" class="column-search " data-column="21"></th>
                                                <th style="display:none"><input type="text" class="column-search" data-column="22"></th>


                                            </tr>
                                        </thead>
                                        <tbody class="LogisticsInfotbody"></tbody>
                                    </table>
                                    <div class="col-md-6 form-group" id="Logisticss" style=" white-space:nowrap; display: flex; margin-top: -4rem; margin-left: 96rem;">
                                        <div style="width: 16px; height: 16px; background-color: lightgreen; border: 1px solid #000; margin-right: 8px;"></div>
                                        <b style="font-weight: bold;">Green Color Column Modify Only</b>
                                        @Html.CheckBoxFor(model => model.SelectLogistics, new { @id = "SelectLogistics" }) Select ALL
                                        <label for="Credit_Advice_Prepared">@resourceSettings.getResourceLable("lblCredit_Advice_Prepared", "common", "Credit_Advice_Prepared")</label>
                                        @Html.TextBoxFor(model => model.Credit_Advice_Prepared, new { @class = "form-control", onclick = "showDate(this);", @id = "txtCCOCredit_Advice_Prepared", style = "width: 150px;" })


                                        @*<div class="col-md-3 setText" style="display: flex; align-items: center; margin-top: 2rem; margin-left: -1rem; ">
                                <label for="Credit_Advice_Details" style="margin-right: 1rem; margin-left: 32rem; white-space: nowrap; ">@resourceSettings.getResourceLable("lblCredit_Advice_Details", "common", "Credit_Advice_Details")</label>
                                @Html.TextBoxFor(model => model.Credit_Advice_Details, new { @class = "form-control", @id = "CCOCredit_Advice_Details", style = "width: 150px;" })
                            </div>*@

                                        <a href="" id="lnkUpdateLogistics" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblUpdate", "common", "Update")</a>
                                        <a href="" id="lnkLogisticsRefresh" class="btn-cancel"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblRefresh", "common", "Refresh")</a>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="tabAccounts" class="tab-pane">
                        <div class="box">
                            <div id="Accountpage" style=" margin-top: 8px; text-align: end; margin-right: 1rem;"></div>

                            <div class="box-body">
                                <div class="table-responsive">
                                    <div id="loadingMessage6" style="text-align:center; padding:20px; font-size:16px; display:none;">
                                        <span><i class="fa fa-spinner fa-spin" style="font-size:100px"></i> Loading data, please wait...</span>
                                    </div>
                                    <table id="TblAccountsInfo" class="table table-bordered table-striped mt-4" style=" margin-top: 3px !important;">
                                        <thead>
                                            <tr style="text-align: center;">
                                                <th class="HeaderFont" style="text-align: center;">Sr No</th>
                                                <th class="HeaderFont" title="PI No"><b>PI No</b></th>
                                                <th class="HeaderFont" title="OCF No">OCF No</th>
                                                <th class="HeaderFont" title="InvoiceNo">InvoiceNo</th>
                                                <th class="HeaderFont" title="InvDate"><b>InvDate</b></th>
                                                <th class="HeaderFont" title="Customer Name">Customer Name</th>
                                                <th class="HeaderFont" title="Commission Vendor Name">Commission Vendor<br />Name</th>
                                                <th class="HeaderFont" title="Commission Type"><b>Commission Type</b></th>
                                                <th class="HeaderFont" title="Sales Person Name">Sales Person<br />Name</th>
                                                <th class="HeaderFont" title="Commission Rate">Commission Rate</th>
                                                <th title="Tentative Commission Basic Amt">Tentative Commission<br />Basic Amt</th>
                                                <th class="HeaderFont" title="ActualCommission"><b>ActualCommission</b></th>
                                                <th class="HeaderFont" title="Tagged ON PI"><b>Tagged ON<br />PI</b></th>
                                                <th class="HeaderFont" title="Tagged On OCF">Tagged On<br />OCF</th>
                                                <th class="HeaderFont" title="Tagged After Invoice"><b>Tagged After<br />Invoice</b></th>
                                                <th class="HeaderFont" title="Claim From Received"><b>Claim From<br />Received</b></th>
                                                <th title="Commission Working Sent To Vendor">Commission Working<br />Sent To Vendor</th>
                                                <th class="HeaderFont" title="Commission Invoice Received">Commission Invoice<br />Received</th>
                                                <th class="HeaderFont" title="Credit Advice Prepared"><b>Credit Advice<br />Prepared</b></th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Select All">Select All</th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Credit Note No"><b>Credit Note<br /> No</b></th>
                                                <th class="HeaderFont" style="background-color: lightgreen; " title="Credit Note Prepared"><b>Credit Note<br />Prepared</b></th>
                                                <th class="HeaderFont" title="From No" style="display:none"><b>Frome No</b></th>
                                                <th class="HeaderFont" title="Vendor code" style="display:none"><b>Vendor code</b></th>

                                            </tr>
                                            <tr>
                                                <th><input type="text" class="column-search srno-search" data-column="0"></th>
                                                <th><input type="text" class="column-search Pi-no-search" data-column="1"></th>
                                                <th><input type="text" class="column-search OCF_No-search" data-column="2"></th>
                                                <th><input type="text" class="column-search Invoice_No-search" data-column="3"></th>
                                                <th><input type="text" class="column-search Invoice_Date-search" data-column="4"></th>
                                                <th><input type="text" class="column-search CustomerName-search" data-column="5"></th>
                                                <th><input type="text" class="column-search Commission_Vendor_Name-search" data-column="6"></th>
                                                <th><input type="text" class="column-search CommissionType-search" data-column="7"></th>
                                                <th><input type="text" class="column-search SalesPerson_Name-search" data-column="8"></th>
                                                <th><input type="text" class="column-search CommissionRate-search" data-column="9"></th>
                                                <th><input type="text" class="column-search Tentative-comm-basic-amt-search" data-column="10"></th>
                                                <th><input type="text" class="column-search ActualCommission-search" data-column="11"></th>
                                                <th><input type="text" class="column-search TaggedOnPI-search" data-column="12"></th>
                                                <th><input type="text" class="column-search TaggedOnOCF-search" data-column="13"></th>
                                                <th><input type="text" class="column-search Tagged-after-invoice-search" data-column="14"></th>
                                                <th><input type="text" class="column-search Claim-from-received-search" data-column="15"></th>
                                                <th><input type="text" class="column-search Commission_Working_sent_Vendor_Employee-search" data-column="16"></th>
                                                <th><input type="text" class="column-search Commission-invoice-received-search" data-column="17"></th>
                                                <th><input type="text" class="column-search Credit-Advice-Prepared-search" data-column="18"></th>
                                                <th><input type="text" class="column-search selectAll-serch" data-column="19"></th>
                                                <th><input type="text" class="column-search selectAll-serch" data-column="20" style="width:65px;"></th>
                                                <th><input type="text" class="column-search Credit-note_prepared-search" data-column="21"></th>
                                                <th style="display:none"><input type="text" class="column-search " data-column="22"></th>
                                                <th style="display:none"><input type="text" class="column-search" data-column="23"></th>
                                            </tr>
                                        </thead>
                                        <tbody class="AccountsInfotbody"></tbody>
                                    </table>
                                    <div class="col-md-9 form-group" id="Accountsf" style="white-space:nowrap; display: flex; margin-top: -4rem; margin-left: 65rem;">
                                        <div style="width: 16px; height: 16px; background-color: lightgreen; border: 1px solid #000; margin-right: 8px;"></div>
                                        <b style="font-weight: bold;">Green Color Column Modify Only</b>
                                        @Html.CheckBoxFor(model => model.SelectAccounts, new { @id = "SelectAll" }) Select ALL
                                        <label for="Claimform_Received">@resourceSettings.getResourceLable("lblCredit_Note_PreparedNo", "common", "Credit Note No")</label>
                                        @Html.TextBoxFor(model => model.CreditNotePreparedNo, new { @class = "form-control", @id = "txtCCOCredit_Note_PreparedNo", style = "width: 150px;" })
                                        <label for="Claimform_Received">@resourceSettings.getResourceLable("lblCredit_Note_Prepared", "common", "Credit Note Prepared")</label>
                                        @Html.TextBoxFor(model => model.Credit_Note_Prepared, new { @class = "form-control", onclick = "showDate(this);", @id = "txtCCOCredit_Note_Prepared", style = "width: 150px;" })
                                        @* @Html.TextBoxFor(model => model.Credit_Advice_Prepared, new { @class = "form-control", @id = "CCOCredit_Advice_Prepared", style = "width: 150px;" })*@

                                        @* <div class="col-md-3 setText">
                <b>@resourceSettings.getResourceLable("lblCredit_Note_Prepared", "common", "Credit Note Prepared")</b>
                @Html.TextBoxFor(model => model.Claimform_Received, new { @class = "form-control", @id = "CCOCredit_Note_Prepared" })
            </div>*@
                                        <a href="" id="lnkUpdateAccounts" class="btn-cancel" style=" text-align: left;"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblUpdate", "common", "Update")</a>
                                        <a href="" id="lnkAccountsRefresh" class="btn-cancel" style=" text-align: left;"><i class="fa fa-eraser"></i>@resourceSettings.getResourceLable("lblRefresh", "common", "Refresh")</a>

                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>


                </div>
            </div>
        </div>
    </section>
}


<link href="~/Content/Css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="~/Content/plugins/datatables/jquery.dataTables.min.css" rel="stylesheet" />

<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
<link href="~/Content/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<link href="~/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
<link href="~/Content/boxicons/css/boxicons.min.css" rel="stylesheet" />
<link href="~/Content/quill/quill.snow.css" rel="stylesheet" />
<link href="~/Content/quill/quill.bubble.css" rel="stylesheet" />
<link href="~/Content/remixicon/remixicon.css" rel="stylesheet" />
<link href="~/Content/simple-datatables/style.css" rel="stylesheet" />
<script src="~/Content/echarts/echarts.min.js"></script>
<script src="~/Content/quill/quill.js"></script>
<script src="~/Content/simple-datatables/simple-datatables.js"></script>
<script src="~/Content/tinymce/tinymce.min.js"></script>
<script src="~/Content/php-email-form/validate.js"></script>

<script src="~/Scripts/main.js"></script>
<link href="~/Scripts/style.css" rel="stylesheet" />
<link href="~/Styles/style.css" rel="stylesheet" />

<script src="~/Scripts/jquery-3.7.1.js"></script>
<script src="~/Scripts/jquery-3.7.1.min.js"></script>
<script src="~/Scripts/jquery.min.js"></script>
<link href="~/Content/themes/base/minified/jquery.ui.tabs.min.css" rel="stylesheet" />
<link href="~/Content/themes/redmond/minified/jquery.ui.tabs.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery-2.1.4.min.js"></script>
<script src="~/Scripts/jquery.datetimepicker.js"></script>
<script src="~/Content/SiteCss/js/jquery.datetimepicker.js"></script>
<link href="~/Content/SiteCss/css/jquery.datetimepicker.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.7.1.min.js"></script>
<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
<link href="~/Content/Css/TSCommon.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap.bundle.js"></script>
<script src="~/Scripts/bootstrap.bundle.min.js"></script>
<script src="~/WebFormScripts/ExtOperation.js"></script>
<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />
<link href="~/Content/themes/redmond/minified/jquery-ui.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.12.4.min.js"></script>

<link href="~/Scripts/bootstrap.min.css" rel="stylesheet" />
<link href="~/Styles/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/assets/css/style.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/Styles/bootstrap.css" rel="stylesheet" />
<link href="~/Styles/bootstrap.min.css" rel="stylesheet" />
<link href="~/Scripts/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/bootstrap/css/bootstrap.min.css" rel="stylesheet" />


<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />
<link href="~/Content/themes/redmond/minified/jquery-ui.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery-ui.js"></script>
<script src="~/Content/plugins/datatables/jquery.dataTables.min.js"></script>

<script src="~/Scripts/ext-all.js"></script>
<link href="~/Styles/ext-all.css" rel="stylesheet" />
<link href="~/Content/Css/ext.css" rel="stylesheet" />

<script type="text/javascript">
    $(document).ready(function () {
        $("#invoiceDateSearch,#INV_Dates,#Claimform_Received,#CommissionworkingsenttoVendor_Employee,#CommissionInvoice_Received,#Credit_Note_Prepared,#Credit_Advice_Prepared,#Claim_form_DateCommercial,#Freight_Bill_DatePost,#Credit_Advice_Prepared,#Claim_form_DateAccounts,#COClaimform_Received").datepicker({
            dateFormat: "dd/mm/yy"
            // Adjust format to match your model
        });
    });
    $(document).ready(function () {


        $('#DataShowPI,#DataShowList,#DataShowPreMarketing,#DataShowCommercial,#DataShowPostMarketing,#DataShowLogistics,#DataShowAccounts').hide();
        $('#lnkAll').on('click', function (e) {

            e.preventDefault();
            $('#invoiceNoSearch').val('');

            var lnkList = document.querySelector('.lnkList');
            if (lnkList && lnkList.classList.contains("active")) {
                console.log("lnkList is active");
                var invoiceNo = ""
            }

            GetData();
        });
        $('#lnkClear').on('click', function (e) {

            e.preventDefault();
            $('#invoiceNoSearch').val('');
            $('#invoiceDateSearch').val('');
            var invoiceNo = $('#invoiceNoSearch').val();
            var invoiceDate = $('#invoiceDateSearch').val();
            var lnkList = document.querySelector('.lnkPreMarketing');
            if (lnkList && lnkList.classList.contains("active")) {
                console.log("lnkList is active");
                var invoiceNo = "";
                var invoiceDateSearch = "";
            }

            GetData(invoiceNo, invoiceDate);
            $('#invoiceDateSearch').val('');
        });
        $('#lnkPremarkSerch').on('click', function (e) {

            e.preventDefault();
            var selectedDate = $('#invoiceDateSearch').val();

            var ObjectType = "PreMarketing";
            var invoiceNo = $('#invoiceNoSearch').val().trim();

            function formatDateToDDMMYYYYFromDateInput(dateStr) {
                if (!dateStr) return "";

                // Check for standard HTML5 input type="date" format
                if (dateStr.includes('-')) {
                    const [year, month, day] = dateStr.split('-');
                    return `${day}/${month}/${year}`; // "20/03/2025"
                }

                // If it's already in dd/mm/yy or something else, just return it or process accordingly
                console.warn("Unexpected date format:", dateStr);
                return dateStr;
            }



            var formattedDate = formatDateToDDMMYYYYFromDateInput(selectedDate);

            var selectedSearchType = $('#searchType').val();
            var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
            $('#loadingMessage2').show();         // Show spinner
            $('#TblPreMarketingInfo').hide();
            $('#rowsd').hide();
                $.ajax({
                    url: urlRequest1,
                    type: 'GET',
                    data:
                    {
                        SearchType: selectedSearchType,
                        ObjectType: ObjectType,
                        invoiceNo: invoiceNo,
                        invoiceDate: selectedDate
                    },
                    success: function (data) {
                        var totalRecords = data.length;
                        var pageLength = 10;
                        var totalPages = Math.ceil(totalRecords / pageLength);
                        var startRecord = 1;
                        var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                        $('#TblPreMarketingInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                        if ($.fn.dataTable.isDataTable('#TblPreMarketingInfo')) {
                            $('#TblPreMarketingInfo').DataTable().destroy();
                        }
                        var rows = '';
                   for (var i = 0; i < data.length; i++) {
        var item = data[i];

         var siTooltip = item.SrNo;
            var PI_noTooltip = item.PI_No;
            var OCF_NoTooltip = item.OCF_No;
            var Invoice_NoTooltip = item.Invoice_No;
            var Invoice_DateTooltip = item.INV_Dates;
            var CustomerNameTooltip = item.CustomerName;
            var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
            var CommissionTypeTooltip = item.CommissionType;
            var SalesPerson_NameTooltip = item.SalesPerson_Name;
            var CommissionRateTooltip = item.CommissionRate;
            var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
            var TaggedOnPITooltip = item.TaggedOnPI;
            var TaggedOnOCFTooltip = item.TaggedOnOCF;
            var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
            var Claimform_ReceivedTooltip = item.Claimform_Received;
            var FromNoTooltip = item.FromNo;
            var VendorNoTooltip = item.Vendor_Code;

            rows += '<tr >';
            rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
            rows += '<td class="PI" title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
            rows += '<td class="OCF" title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
            rows += '<td class="Invoice" title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
          //  var formattedClaimDate5 = formatDateToShortDMY(item.INV_Dates);
          //  rows += '<td title="' + Invoice_DateTooltip + '">' + formattedClaimDate5 + '</td>';
            rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
            rows += '<td  style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
            rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" class="VendorName" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
            rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
            rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;"   title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
            rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
            rows += '<td  style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
            rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
            rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

            rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

            rows += '<td style="text-align: center;"><input type="checkbox" Id="CheckboxPre" class="row-checkbox All-CheckedFacyPre" /></td>';


            if (item.Claimform_Received) {
               // var formattedClaimDate = formatDateToShortDMY(item.Claimform_Received);
                rows += '<td title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
            } else {
                rows += '<td title="' + Claimform_ReceivedTooltip + '">';
                rows += '@Html.TextBoxFor(model => model.Claimform_Received, new { @class = "form-control", @id = "CCO_Claimform_Received", style = "font-size: 14px !important;width: 90%;" })';
                rows += '</td>';
            }
            rows += '<td class="FromNo" style="display: none;" title="' + FromNoTooltip + '">' + item.FromNo + '</td>';
            rows += '<td class="Vendor_Code" style="display: none;" title="' + VendorNoTooltip + '">' + item.Vendor_Code + '</td>';
            rows += '</tr>';
    }

                        $('.PreMarketingInfotbody').html(rows);
                        $('#loadingMessage2').hide();         // Show spinner
                        $('#TblPreMarketingInfo').show();
                        $('#rowsd').show();
                        var table = $('#TblPreMarketingInfo').DataTable({
                            paging: true,
                            searching: true,
                            ordering: true,
                            "lengthMenu": [10, 25, 50, 100],
                            "pageLength": 10,
                            language: {
                                emptyTable: "No Data Found"
                            },
                            initComplete: function () {
                                moveLengthDropdown();
                            },
                            drawCallback: function () {
                                moveLengthDropdown();
                            }
                        });

                        function moveLengthDropdown() {

                            $('#TblPreMarketingInfo_filter').hide();

                            // Only move if it's still inside the original wrapper
                            var $length = $('#TblPreMarketingInfo_wrapper').find('#TblPreMarketingInfo_length');  // Get the length menu
                            var $target = $('#lengthSelectorWrapper');  // Target container to move the length menu to

                            if ($length.length && $target.length) {  // Ensure both are present in DOM
                                // Remove existing length menu from target if already there
                                $target.find('#TblPreMarketingInfo_length').remove();

                                // Append and style the length menu
                                $length.appendTo($target).css({
                                    'margin-top': '0px',
                                    'text-align': 'end',
                                    'display': 'inline-block'
                                });
                            } else {
                                console.warn("Either #TblPreMarketingInfo_length or #lengthSelectorWrapper is missing.");
                            }
                        }
                        $('.Invoice_Date-search').on('keyup change', function () {
                            var column = $('#TblPreMarketingInfo').DataTable().column($(this).data('column'));
                            column.search(this.value).draw();
                        });
                        $('[data-toggle="tooltip"]').tooltip();
                        $('[title]').tooltip();

                    }
                });

            $('#invoiceDateSearch').val('');

        });
        $('#lnkPremarrefresh').on('click', function (e) {
            e.preventDefault();

            // Optional: check if lnkPreMarketing is active before calling
            if ($('#lnkPreMarketing').hasClass('active')) {
                GetData();
            }
        });
        $('#lnkCommercialRefresh').on('click', function (e) {
            e.preventDefault();

            // Optional: check if lnkPreMarketing is active before calling
            if ($('#lnkCommercial').hasClass('active')) {
                GetData();
            }
        });
        $('#lnkPostMarketingRefresh').on('click', function (e) {
            e.preventDefault();

            // Optional: check if lnkPreMarketing is active before calling
            if ($('#lnkPostMarketing').hasClass('active')) {
                GetData();
            }
        });
        $('#lnkLogisticsRefresh').on('click', function (e) {
            e.preventDefault();

            // Optional: check if lnkPreMarketing is active before calling
            if ($('#lnkLogistics').hasClass('active')) {
                GetData();
            }
        });
        $('#SelectCommercial').click(function () {
            $('.All-CheckedFacyCom').prop('checked', this.checked);
        });
        $('#SelectPostMarketing').click(function () {
            $('.All-CheckedFacyPost').prop('checked', this.checked);
        });
        $('#SelectAll').click(function () {
            $('.All-CheckedFacy').prop('checked', this.checked);
        });
        $('#SelectLogistics').click(function () {
            $('.All-CheckedFacyLog').prop('checked', this.checked);
        });
        $('#SelectPreMarketing').click(function () {
            $('.All-CheckedFacyPre').prop('checked', this.checked);
        });
        $('#lnkAccountsRefresh').on('click', function (e) {
            e.preventDefault();

            // Optional: check if lnkPreMarketing is active before calling
            if ($('#lnkAccounts').hasClass('active')) {
                GetData();
            }
        });
        $('#lnkUpdatePremarketing').click(function (e) {

            e.preventDefault();
            var rowsData = [];
            if ($('.All-CheckedFacyPre:checked').length > 0) {
                var rowsData = [];
                $('.All-CheckedFacyPre:checked').each(function () {

                    var rowElement = $(this).closest('tr');

                    var Claim_form_DatepreMarTV = rowElement.find('#CCO_Claimform_Received').val();
                    var Claim_form_DatepreMarGrid = rowElement.find('.CO_Claimform_Received').text();
                    var Claim_form_DatepreMarTH = document.getElementById("Claim_form_DatepreMar").value;
                    if (Claim_form_DatepreMarTV != null && Claim_form_DatepreMarTV != "" && (Claim_form_DatepreMarGrid == null || Claim_form_DatepreMarGrid == "") && (Claim_form_DatepreMarTH == null || Claim_form_DatepreMarTH == "")) {
                        var Claim_form_DatepreMar = Claim_form_DatepreMarTV;
                    }
                    else if (Claim_form_DatepreMarGrid === undefined && Claim_form_DatepreMarGrid !== null && (Claim_form_DatepreMarTH == null || Claim_form_DatepreMarTH == "")) {
                        var Claim_form_DatepreMar = Claim_form_DatepreMarGrid;
                    }
                    else {
                        var Claim_form_DatepreMar = Claim_form_DatepreMarTH;
                    }
                    var PI_No = rowElement.find('.PI').text().trim();
                    var OCF_No = rowElement.find('.OCF').text().trim();
                    var Invoice_No = rowElement.find('.Invoice').text().trim();
                    var Commission_Vendor_Name = rowElement.find('.VendorName').text().trim();

                    var Vendorno = rowElement.find('.Vendor_Code').text().trim();
                    var FromNo = rowElement.find('.FromNo').text().trim();
                    var rowData = {
                        "PI_No": PI_No,
                        "OCF_No": OCF_No,
                        "Invoice_No": Invoice_No,
                        "Commission_Vendor_Name": Commission_Vendor_Name,
                        "Claimform_Received": Claim_form_DatepreMar,
                        "Vendor_Code": Vendorno,
                        "FromNo": FromNo

                    };
                    rowsData.push(rowData);
                });
                var urlRequest = '@Url.Action("GetDataUpadatePreMarketing", "Commissiontracker")';
                $('#loadingMessage2').show();         // Show spinner
                $('#TblPreMarketingInfo').hide();
                $('#rowsd').hide();
                $.ajax({
                    url: urlRequest,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ rowsData: rowsData }),
                    success: function (data) {

                        if (data.Status == true) {
                            var inserted = 0;
                            var updated = 0;
                            if (data.Records && data.Records.length > 0) {
                                data.Records.forEach(function (record) {
                                    if (record.Status === "Inserted") {
                                        inserted++;
                                    } else if (record.Status === "Updated") {
                                        updated++;
                                    }
                                });
                            }
                            $('#loadingMessage2').hide();         // Show spinner
                            $('#TblPreMarketingInfo').show();
                            $('#rowsd').show();
                            var message = "Successfully processed records.\n";
                            if (inserted > 0) message += inserted + " record(s) inserted.\n";
                            if (updated > 0) message += updated + " record(s) updated.";
                            alert(message);
                            GetData();
                           @* var rowDataMsg = "Successfully Updated Records";
                            alert(rowDataMsg);
                            GetData();*@
                        } else {
                            alert("Failed to Update Records");
                            GetData();
                        }
@*                        else {
                            var rowDataMsg = "Failed to Update Records";
                            alert(rowDataMsg);
                            GetData();
                        }*@
                    },
                    error: function (xhr, ret, e) {
                        alert('Error: ' + e);
                    }
                });
                $('.All-CheckedFacyPre').prop('checked', false);
                $('#SelectPreMarketing').prop('checked', false);
                $('#CCO_Commissionsenttovendor,#CO_Commissionsenttovendor,#Commission_working_DatePost,#Remarks,#CCO_Remarks,#CO_Remarks').val('');
            };
        });
             $('#lnkUpdateCommercial').click(function (e) {
            e.preventDefault();
            var rowsData = [];
            if ($('.All-CheckedFacyCom:checked').length > 0) {
                var rowsData = [];
                $('.All-CheckedFacyCom:checked').each(function () {

                    var rowElement = $(this).closest('tr');
                    var Commission_working_DateTV = rowElement.find('#CCO_Commissionsenttovendor').val();
                    var Commission_working_DateGrid = rowElement.find('.CO_Commissionsenttovendor').text();
                    var Commission_working_DateTH = document.getElementById("Commission_working_DatePost").value;
                    if (Commission_working_DateTV != null && Commission_working_DateTV != "" && (Commission_working_DateGrid == null || Commission_working_DateGrid == "") && (Commission_working_DateTH == null || Commission_working_DateTH == "")) {
                        var Commission_working_Date = Commission_working_DateTV;
                    }
                    else if (Commission_working_DateGrid === undefined && Commission_working_DateGrid !== null && (Commission_working_DateTH == null || Commission_working_DateTH == "")) {
                        var Commission_working_Date = Commission_working_DateGrid;
                    }
                    else {
                        var Commission_working_Date = Commission_working_DateTH;
                    }
                    var RemarksTV = rowElement.find('#CCO_Remarks').val();
                    var RemarksGrid = rowElement.find('.CO_Remarks').text();
                    var RemarksTH = document.getElementById("Remarks").value;
                    if (RemarksTV != null && RemarksTV != "" && (RemarksGrid == null || RemarksGrid == "") && (RemarksTH == null || RemarksTH == "")) {
                        var Remarks = RemarksTV;
                    }
                    else if (RemarksGrid === undefined && RemarksGrid !== null && (RemarksTH == null || RemarksTH == "")) {
                        var Remarks = RemarksGrid;
                    }
                    else {
                        var Remarks = RemarksTH;
                    }
                    var ActualCommissionTV = rowElement.find('#CCO_ActualCommission').val();
                    var ActualCommissionGrid = rowElement.find('.CO_ActualCommission').text();
                   // var ActualCommissionTH = rowElement.find('#ActualCommission').val();
                    //var ActualCommissionTH = rowElement.find('#ActualCommission').val();
                   // var ActualCommissionTH = document.getElementById("txtActualCommision").val();
                    var ActualCommissionTH = $("#txtActualCommision").val();
                    if (ActualCommissionTV != null && ActualCommissionTV != "" && (ActualCommissionGrid == null || ActualCommissionGrid == "") && (ActualCommissionTH == null || ActualCommissionTH == "")) {
                        var ActualCommission = ActualCommissionTV;
                    }
                    else if (ActualCommissionGrid === undefined && ActualCommissionGrid !== null && (ActualCommissionTH == null || ActualCommissionTH == "")) {
                        var ActualCommission = ActualCommissionGrid;
                    }
                    else {
                        var ActualCommission = ActualCommissionTH;
                    }
                    var PI_No = rowElement.find('.PI_No').text().trim();
                    var OCF_No = rowElement.find('.OCF_No').text().trim();
                    var Invoice_No = rowElement.find('.Invoice_No').text().trim();
                    var Commission_Vendor_Name = rowElement.find('.Commission_Vendor_Name').text().trim();
                    var Claimform_Received = rowElement.find('.Claimform_Received').text().trim();
                    var Vendorno = rowElement.find('.Vendor_Code').text().trim();
                    var FromNo = rowElement.find('.FromNo').text().trim();
                    var rowData = {
                        "PI_No": PI_No,
                        "OCF_No": OCF_No,
                        "Invoice_No": Invoice_No,
                        "Commission_Vendor_Name": Commission_Vendor_Name,
                        "Claimform_Received": Claimform_Received,
                        "CommissionworkingsenttoVendor_Employee": Commission_working_Date,
                        "Remarks": Remarks,
                        "ActualCommission": ActualCommission,
                        "Vendor_Code": Vendorno,
                        "FromNo": FromNo

                    };
                    rowsData.push(rowData);
                });
                var urlRequest = '@Url.Action("GetDataUpadateCommercial", "Commissiontracker")';
                $.ajax({
                    url: urlRequest,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ rowsData: rowsData }),
                    success: function (data) {

                        if (data.Status == true) {
                            var inserted = 0;
                            var updated = 0;
                            if (data.Records && data.Records.length > 0) {
                                data.Records.forEach(function (record) {
                                    if (record.Status === "Inserted") {
                                        inserted++;
                                    } else if (record.Status === "Updated") {
                                        updated++;
                                    }
                                });
                            }
                            var message = "Successfully processed records.\n";
                            if (inserted > 0) message += inserted + " record(s) inserted.\n";
                            if (updated > 0) message += updated + " record(s) updated.";
                            alert(message);
                            GetData();
                           @* var rowDataMsg = "Successfully Updated Records";
                            alert(rowDataMsg);
                            GetData();*@
                        } else {
                            alert("Failed to Update Records");
                            GetData();
                        }
@*                        else {
                            var rowDataMsg = "Failed to Update Records";
                            alert(rowDataMsg);
                            GetData();
                        }*@
                    },
                    error: function (xhr, ret, e) {
                        alert('Error: ' + e);
                    }
                });
                $('.All-CheckedFacyCom').prop('checked', false);
                $('#SelectCommercial').prop('checked', false);
                $('#CCO_Commissionsenttovendor,#CO_Commissionsenttovendor,#Commission_working_DatePost,#txtActualCommision,#Remarks,#CCO_Remarks,#CO_Remarks').val('');
            };
        });
        $('#lnkUpdatePost').click(function (e) {
            e.preventDefault();
            var rowsData = [];
            if ($('.All-CheckedFacyPost:checked').length > 0) {
                var rowsData = [];
                $('.All-CheckedFacyPost:checked').each(function () {

                    var rowElement = $(this).closest('tr');
                    //  var Doc_No = rowElement.find('.Doc_No').text();

                    var CClaimform_ReceivedTV = rowElement.find('#CCO_Claimform_Received').val();
                    var CClaimform_ReceivedGrid = rowElement.find('.CO_Claimform_Received').text();
                    var CClaimform_ReceivedTH = document.getElementById("Claimform_ReceivedDate").value;
                    if (CClaimform_ReceivedTV != null && CClaimform_ReceivedTV != "" && (CClaimform_ReceivedGrid == null || CClaimform_ReceivedGrid == "") && (CClaimform_ReceivedTH == null || CClaimform_ReceivedTH == "")) {
                        var Claimform_Received = CClaimform_ReceivedTV;
                    }
                    else if (CClaimform_ReceivedGrid === undefined && CClaimform_ReceivedGrid !== null && (CClaimform_ReceivedTH == null || CClaimform_ReceivedTH == "")) {
                        var Claimform_Received = CClaimform_ReceivedGrid;
                    }
                    else {
                        var Claimform_Received = CClaimform_ReceivedTH;
                    }

                    var Vendorno = rowElement.find('.Vendor_Code').text().trim();
                    var FromNo = rowElement.find('.FromNo').text().trim();

                    var rowData = {

                        "Claimform_Received": Claimform_Received,
                        "Vendor_Code": Vendorno,
                        "FromNo": FromNo
                    };
                    rowsData.push(rowData);
                });
                var urlRequest = '@Url.Action("GetDataUpadatePostMarketing", "Commissiontracker")';
                $.ajax({
                    url: urlRequest,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ rowsData: rowsData }),
                    success: function (data) {
                        if (data.Status == true) {
                            var rowDataMsg = "Successfully Updated Records";
                            alert(rowDataMsg);
                            GetData();
                        }
                        else {
                            var rowDataMsg = "Failed to Update Records";
                            alert(rowDataMsg);
                            GetData();
                        }
                    },
                    error: function (xhr, ret, e) {
                        alert('Error: ' + e);
                    }
                });
                $('.All-CheckedFacyPost').prop('checked', false);
                $('#SelectPostMarketing').prop('checked', false);
                $('#CCO_Claimform_Received,#Claimform_ReceivedDate,CO_Claimform_Received').val('');

            };
        });
                $('#lnkUpdatePostMarketing').click(function (e) {
            e.preventDefault();
            var rowsData = [];
            if ($('.All-CheckedFacyPost:checked').length > 0) {
                var rowsData = [];
                $('.All-CheckedFacyPost:checked').each(function () {

                    var rowElement = $(this).closest('tr');
                    //  var Doc_No = rowElement.find('.Doc_No').text();

                    var CClaimform_ReceivedTV = rowElement.find('#CCO_Claimform_Received').val();
                    var CClaimform_ReceivedGrid = rowElement.find('.CO_Claimform_Received').text();
                    var CClaimform_ReceivedTH = document.getElementById("Claimform_ReceivedDate").value;
                    if (CClaimform_ReceivedTV != null && CClaimform_ReceivedTV != "" && (CClaimform_ReceivedGrid == null || CClaimform_ReceivedGrid == "") && (CClaimform_ReceivedTH == null || CClaimform_ReceivedTH == "")) {
                        var Claimform_Received = CClaimform_ReceivedTV;
                    }
                    else if (CClaimform_ReceivedGrid === undefined && CClaimform_ReceivedGrid !== null && (CClaimform_ReceivedTH == null || CClaimform_ReceivedTH == "")) {
                        var Claimform_Received = CClaimform_ReceivedGrid;
                    }
                    else {
                        var Claimform_Received = CClaimform_ReceivedTH;
                    }
                    var CCommissionInvoice_ReceivedTV = rowElement.find('#CCO_CommissionInvoice_Received').val();
                    var CCommissionInvoice_ReceivedGrid = rowElement.find('.CO_CommissionInvoice_Received').text();
                    var CCommissionInvoice_ReceivedTH = document.getElementById("CommissionInvoiceReceivedPost").value;
                    if (CCommissionInvoice_ReceivedTV != null && CCommissionInvoice_ReceivedTV != "" && (CCommissionInvoice_ReceivedGrid == null || CCommissionInvoice_ReceivedGrid == "") && (CCommissionInvoice_ReceivedTH == null || CCommissionInvoice_ReceivedTH == "")) {
                        var CommissionInvoice_ReceivedON = CCommissionInvoice_ReceivedTV;
                    }
                    else if (CCommissionInvoice_ReceivedGrid === undefined && CCommissionInvoice_ReceivedGrid !== null && (CCommissionInvoice_ReceivedTH == null || CCommissionInvoice_ReceivedTH == "")) {
                        var CommissionInvoice_ReceivedON = CCommissionInvoice_ReceivedGrid;
                    }
                    else {
                        var CommissionInvoice_ReceivedON = CCommissionInvoice_ReceivedTH;
                    }

                    var Vendorno = rowElement.find('.Vendor_Code').text().trim();
                    var FromNo = rowElement.find('.FromNo').text().trim();

                    var rowData = {
                        "CommissionInvoice_Received": CommissionInvoice_ReceivedON,
                        "Claimform_Received": Claimform_Received,
                        "Vendor_Code": Vendorno,
                        "FromNo": FromNo
                    };
                    rowsData.push(rowData);
                });
                var urlRequest = '@Url.Action("GetDataUpadatePostMarketing", "Commissiontracker")';
                $.ajax({
                    url: urlRequest,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ rowsData: rowsData }),
                    success: function (data) {
                        if (data.Status == true) {
                            var rowDataMsg = "Successfully Updated Records";
                            alert(rowDataMsg);
                            GetData();
                        }
                        else {
                            var rowDataMsg = "Failed to Update Records";
                            alert(rowDataMsg);
                            GetData();
                        }
                    },
                    error: function (xhr, ret, e) {
                        alert('Error: ' + e);
                    }
                });
                $('.All-CheckedFacyPost').prop('checked', false);
                $('#SelectPostMarketing').prop('checked', false);
                $('#CCO_Claimform_Received,#CCO_CommissionInvoice_Received,#Claim_form_DatePost,#ActualCommission,CO_CommissionInvoice_Received,#CommissionInvoiceReceivedPost,CO_Claimform_Received').val('');
            };
        });
        $('#lnkUpdateLogistics').click(function (e) {
            e.preventDefault();
            // Get textbox values
            @*var prepared = $('#CCOCredit_Advice_Prepared').val().trim();
            var details = $('#CCOCredit_Advice_Details').val().trim();

            if (!prepared) {
                alert("Please enter Credit Advice Prepared.");
                return;
            }

            if (!details) {
                alert("Please enter Credit Advice Details.");
                return;
            } // Stop processing if validation fails
*@
            var rowsData = [];
            if ($('.All-CheckedFacyLog:checked').length > 0) {
                var rowsData = [];
                $('.All-CheckedFacyLog:checked').each(function () {

                    var rowElement = $(this).closest('tr');
                    //  var Doc_No = rowElement.find('.Doc_No').text();

                    var FBillRecdONTV = rowElement.find('#CCO_Credit_Advice_Prepared').val();
                    var FBillRecdONGrid = rowElement.find('.CO_Credit_Advice_Prepared').text();
                    var FBillRecdONTH = $("#txtCCOCredit_Advice_Prepared").val();
                    if (FBillRecdONTV != null && FBillRecdONTV != "" && (FBillRecdONGrid == null || FBillRecdONGrid == "") && (FBillRecdONTH == null || FBillRecdONTH == "")) {
                        var FreightBillRecdON = FBillRecdONTV;
                    }
                    else if (FBillRecdONGrid === undefined && FBillRecdONGrid !== null && (FBillRecdONTH == null || FBillRecdONTH == "")) {
                        var FreightBillRecdON = FBillRecdONGrid;
                    }
                    else {
                        var FreightBillRecdON = FBillRecdONTH;
                    }
                    var CCreditadvicedetailsTV = rowElement.find('#CCO_Credit_Advice_Details').val();
                    var CCreditadvicedetailsGrid = rowElement.find('.CO_Credit_Advice_details').text();
                  @*  var CCreditadvicedetailsTH = document.getElementById("CCOCredit_Advice_Details").value;*@
                    if (CCreditadvicedetailsTV != null && CCreditadvicedetailsTV != "" && (CCreditadvicedetailsGrid == null || CCreditadvicedetailsGrid == "") && (CCreditadvicedetailsTH == null || CCreditadvicedetailsTH == "")) {
                        var CreditAdviceDetailsON = CCreditadvicedetailsTV;
                    }
                    else {
                        var CreditAdviceDetailsON = CCreditadvicedetailsGrid;
                    }
                  @*  else if (CCreditadvicedetailsGrid === undefined && CCreditadvicedetailsGrid !== null && (CCreditadvicedetailsTH == null || CCreditadvicedetailsTH == "")) {
                        var CreditAdviceDetailsON = CCreditadvicedetailsGrid;
                    }*@
                  @*  else {
                        var CreditAdviceDetailsON = CCreditadvicedetailsTH;
                    }*@

                    var Vendorno = rowElement.find('.Vendor_Code').text().trim();
                    var FromNo = rowElement.find('.FromNo').text().trim();

                    var rowData = {
                        "Credit_Advice_Details": CreditAdviceDetailsON,
                        "Credit_Advice_Prepared": FreightBillRecdON,
                        "Vendor_Code": Vendorno,
                        "FromNo": FromNo
                    };
                    rowsData.push(rowData);
                });
                var urlRequest = '@Url.Action("GetDataUpadateLogistic", "Commissiontracker")';
                $.ajax({
                    url: urlRequest,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ rowsData: rowsData }),
                    success: function (data) {
                        if (data.Status == true) {
                            var rowDataMsg = "Successfully Updated Records";
                            alert(rowDataMsg);
                            GetData();
                        }
                        else {
                            var rowDataMsg = "Failed to Update Records";
                            alert(rowDataMsg);
                            GetData();
                        }
                    },
                    error: function (xhr, ret, e) {
                        alert('Error: ' + e);
                    }
                });
                $('.All-CheckedFacyLog').prop('checked', false);
                $('#SelectLogistics').prop('checked', false);
                $('#CCO_Credit_Advice_Prepared,#CCOCredit_Advice_Prepared,CO_Credit_Advice_Prepared,#CCO_Credit_Advice_Details,CO_Credit_Advice_details').val('');
            };
        });
            $('#lnkUpdateAccounts').click(function (e) {
       e.preventDefault();
       var rowsData = [];
     
       if ($('.All-CheckedFacy:checked').length > 0) {
           var rowsData = [];
           $('.All-CheckedFacy:checked').each(function () {

               var rowElement = $(this).closest('tr');
               //  var Doc_No = rowElement.find('.Doc_No').text();

               var CNPNONTV = rowElement.find('#CCO_CreditNotePreparedNo').val();
               var CNPNONGrid = rowElement.find('.CO_CreditNotePreparedNo').text();
               var CNPNONTH = $("#txtCCOCreditNotePreparedNo").val();

               if (CNPNONTV != null && CNPNONTV != "" && (CNPNONGrid == null || CNPNONGrid == "") && (CNPNONTH == null || CNPNONTH == "")) {
                   var CreditNotePreparedNoRecdON =CNPNONTV;
               }
               else if( CNPNONGrid === undefined && CNPNONGrid !== null && (CNPNONTH == null || CNPNONTH == "")) {
                   var CreditNotePreparedNoRecdON = CNPNONGrid;
               }
               else {
                   var CreditNotePreparedNoRecdON = CNPNONTH;
               }

               var FBillRecdONTV = rowElement.find('#CCO_Credit_Note_Prepared').val();
               var FBillRecdONGrid = rowElement.find('.CO_Credit_Note_Prepared').text();
               var FBillRecdONTH = $("#txtCCOCredit_Note_Prepared").val();

               var Vendorno = rowElement.find('.Vendor_Code').text().trim();
               var FromNo = rowElement.find('.FromNo').text().trim();
               if (FBillRecdONTV != null && FBillRecdONTV != "" && (FBillRecdONGrid == null || FBillRecdONGrid == "") && (FBillRecdONTH == null || FBillRecdONTH == "")) {
                   var FreightBillRecdON = FBillRecdONTV;
               }
               else if (FBillRecdONGrid === undefined && FBillRecdONGrid !== null && (FBillRecdONTH == null || FBillRecdONTH == "")) {
                   var FreightBillRecdON = FBillRecdONGrid;
               }
               else {
                   var FreightBillRecdON = FBillRecdONTH;
               }


            
               var rowData = {

                   "CreditNotePreparedNo": CreditNotePreparedNoRecdON,
                   "Credit_Note_Prepared": FreightBillRecdON,
                   "Vendor_Code": Vendorno,
                   "FromNo": FromNo

               };
               rowsData.push(rowData);
               debugger
           });

           if (!isValid) {
               return;   // <-- Controller will NOT be called
           }
           var urlRequest = '@Url.Action("GetDataUpadateAccount", "Commissiontracker")';
           $.ajax({
               url: urlRequest,
               type: 'POST',
               contentType: 'application/json',
               data: JSON.stringify({ rowsData: rowsData }),
               success: function (data) {
                   if (data.Status == true) {
                       var rowDataMsg = "Successfully Updated Records";
                       alert(rowDataMsg);
                       GetData();
                   }
                   else {
                       var rowDataMsg = "Failed to Update Records";
                       alert(rowDataMsg);
                       GetData();
                   }
               },
               error: function (xhr, ret, e) {
                   alert('Error: ' + e);
               }
           });
           $('.All-CheckedFacy').prop('checked', false);
           $('#SelectAll').prop('checked', false);
           $('#CCO_Credit_Note_Prepared,CO_Credit_Note_Prepared,#txtCCOCredit_Note_Prepared').val('');
       };
   });
        $('#lnkSave').on('click', function (e) {
            e.preventDefault();
               var invoiceNo = $('#invoiceNoSearch').val().trim();
            var selectedSearchType = $('#searchType').val();

            var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
            $('#loadingMessage1').show();         // Show spinner
            $('#TblcommissionInfo').hide();
                $.ajax({
                    url: urlRequest1,
                    type: 'GET',
                    data:
                    {
                        invoiceNo: invoiceNo,
                        SearchType: selectedSearchType,
                    },


                    success: function (data) {
                        var totalRecords = data.length;
                        var pageLength = 20;
                        var totalPages = Math.ceil(totalRecords / pageLength);
                        var startRecord = 1;
                        var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                        $('#TblcommissionInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                        if ($.fn.dataTable.isDataTable('#TblcommissionInfo')) {
                            $('#TblcommissionInfo').DataTable().destroy();
                        }
                        var rows = '';
                        for (var i = 0; i < data.length; i++) {
                            var item = data[i];

                            var siTooltip = item.SrNo;
                            var PI_noTooltip = item.PI_No;
                            var OCF_NoTooltip = item.OCF_No;
                            var Invoice_NoTooltip = item.Invoice_No;
                            var Invoice_DateTooltip = item.INV_Dates;
                            var CustomerNameTooltip = item.CustomerName;
                            var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                            var CommissionTypeTooltip = item.CommissionType;
                            var CommissionRateTooltip = item.CommissionRate;
                            var SalesPerson_NameTooltip = item.SalesPerson_Name;
                            var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                            var TaggedOnPITooltip = item.TaggedOnPI;
                            var TaggedOnOCFTooltip = item.TaggedOnOCF;
                            var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                            var Claimform_ReceivedTooltip = item.Claimform_Received;
                            var CommissionworkingsenttoVendor_EmployeeTooltip = item.CommissionworkingsenttoVendor_Employee;
                            var CommissionInvoice_ReceivedTooltip = item.CommissionInvoice_Received;
                            var Credit_Note_PreparedTooltip = item.Credit_Note_Prepared;
                            var CreditAdviceDetailsTooltip = item.Credit_Advice_Details;
                            var Vendor_CodeTooltip = item.Vendor_Code;
                            var CreditAdvicePreparedTooltip = item.Credit_Advice_Prepared;
                            let creditnotepreparedvalue = item.Credit_Note_Prepared
                            let rowClass = '';
                            debugger
                            if (creditnotepreparedvalue && creditnotepreparedvalue.trim() !== '') {
                                rowClass = 'tr-green'; // make it green if has value
                            }
                            else { rowClass = ''; }
                            rows += `<tr class="${rowClass}">`;
                            rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                            rows += '<td class="PI_No" title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                            rows += '<td class="OCF_No" title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                            rows += '<td class="Invoice_No" title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                            //  var formattedClaimDate5 = formatDateToShortDMY(item.INV_Dates);
                            rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                            // rows += '<td  title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                            rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                            rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                            rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
                            rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                            rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;"  title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                            rows += '<td style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                            rows += '<td style="text-align: end;" title="' + ActualCommissionTooltip + '">' + item.ActualCommission + '</td>';
                            rows += '<td title="' + CommissionworkingsenttoVendor_EmployeeTooltip + '">' + item.CommissionworkingsenttoVendor_Employee + '</td>';
                            rows += '<td title="' + CommissionInvoice_ReceivedTooltip + '">' + item.CommissionInvoice_Received + '</td>';
                            rows += '<td title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
                            rows += '<td title="' + CreditAdvicePreparedTooltip + '">' + item.Credit_Advice_Prepared + '</td>';
                            rows += '<td class="" title="' + CreditAdviceDetailsTooltip + '">' + item.Credit_Advice_Details + '</td>';
                            rows += '<td title="' + Credit_Note_PreparedTooltip + '">' + item.Credit_Note_Prepared + '</td>';
                            rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                            rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                            rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

                            //     var formattedClaimDate1 = formatDateToShortDMY(item.Claimform_Received);


                            // var formattedClaimDate = formatDateToShortDMY(item.CommissionworkingsenttoVendor_Employee);


                            // var formattedClaimDate2 = formatDateToShortDMY(item.CommissionInvoice_Received);



                            rows += '<td title="' + Vendor_CodeTooltip + '">' + item.Vendor_Code + '</td>';
                            rows += '</tr>';
                        }

                        $('.commissionInfotbody').html(rows);
                        $('#loadingMessage1').hide();
                        $('#TblcommissionInfo').show();
                        var table = $('#TblcommissionInfo').DataTable({
                            paging: true,
                            searching: true,
                            ordering: true,
                            lengthMenu: [20, 25, 50, 100],
                            pageLength: 20,
                            language: {
                                emptyTable: "No Data Found"
                            },
                            initComplete: function () {


                                moveLengthDropdown();
                            },
                            drawCallback: function () {
                                moveLengthDropdown();
                            }
                        });

                        function moveLengthDropdown() {
                            // Only move if it's still inside the original wrapper
                            $('#TblcommissionInfo_filter').hide();


                            var $length = $('#TblcommissionInfo_wrapper').find('#TblcommissionInfo_length');  // Get the length menu
                            var $target = $('#commissionpage');  // Target container to move the length menu to

                            if ($length.length && $target.length) {  // Ensure both are present in DOM
                                // Remove existing length menu from target if already there
                                $target.find('#TblcommissionInfo_length').remove();

                                // Append and style the length menu
                                $length.appendTo($target).css({
                                    'margin-top': '22px',
                                    'text-align': 'end',
                                    'display': 'inline-block'
                                });
                            } else {
                                console.warn("Either #TblcommissionInfo_length or #commissionpage is missing.");
                            }

                        }



                    }
                });
            $('#invoiceNoSearch').val('');
        });
        $('#lnkDeleteRecore').click(function () {

            var PI_No = document.getElementById("PI_No").value;
            var OCF_No = document.getElementById("OCF_No").value;
            var Invoice_No = document.getElementById("Invoice_No").value;
           // var OCF_No = rowElement.find('.OCF_No').val().trim();
          //  var OCF_No = rowElement.find('input.OCF_No').val()?.trim() || "";
          @*  var PI_No = $('#PI_No').val();
            var OCF_No = $('#OCF_No').val();
            var Invoice_No = $('#Invoice_No').val();*@
          @*  var PI_No = rowElement.find('.input.PI_No').val()?.trim() || "";
            var OCF_No = rowElement.find('.input.OCF_No').val()?.trim() || "";
            var Invoice_No = rowElement.find('.input.Invoice_No').val()?.trim() || "";*@
           @* var PI_No = rowElement.find('.PI_No').text().trim();
            var OCF_No = rowElement.find('.OCF_No').text().trim();
            var Invoice_No = rowElement.find('.Invoice_No').text().trim();*@

          //  rowsData.push(rowData);

                    var urlRequest = '@Url.Action("DetailsDeleteRecored", "Commissiontracker")';
                    $.ajax({
                        url: urlRequest,
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            "PI_No": PI_No,
                            "OCF_No": OCF_No,
                            "Invoice_No": Invoice_No}),
                        success: function (data) {
                            if (data.returnVal == true, data.MSG != null) {
                                alert('Record deleted successfully...');
                                document.getElementById("lnkRefreshDetails").click();
                            }
                            else {
                                alert('Not Record deleted successfully...');
                            }
                        },
                        error: function (xhr, ret, e) {
                        }
                    });
        });
       $('#lnkSaveDetails').click(function (event) {

           event.preventDefault();
           function getVal(id) {
               var v = document.getElementById(id).value.trim();
               return v === "" ? null : v;
           }
           var FromNo = document.getElementById("FromNo").value;
           var OCF_No = document.getElementById("OCF_No").value;
           var Invoice_No = document.getElementById("Invoice_No").value;
           var PI_No = document.getElementById("PI_No").value;
           var ActualCommission = getVal("ActualCommission");
           var Claimform_Received = getVal("Claimform_Received");
           var CommissionworkingsenttoVendor_Employee = getVal("CommissionworkingsenttoVendor_Employee");
           var CommissionInvoice_Received = getVal("CommissionInvoice_Received");
           var Credit_Advice_Prepared = getVal("Credit_Advice_Prepared");
           var Credit_Advice_Details = getVal("Credit_Advice_Details");
           var CreditNotePreparedNo = getVal("CreditNotePreparedNo");
           var Credit_Note_Prepared = getVal("Credit_Note_Prepared");
           var Commission_Vendor_Name = getVal("Commission_Vendor_Name");
           var Vendor_Code = getVal("Vendor_Code");
           //var ActualCommission = document.getElementById("ActualCommission").value;
           //var Claimform_Received = document.getElementById("Claimform_Received").value;
           //var CommissionworkingsenttoVendor_Employee = document.getElementById("CommissionworkingsenttoVendor_Employee").value;
           //var CommissionInvoice_Received = document.getElementById("CommissionInvoice_Received").value;
           //var Credit_Advice_Prepared = document.getElementById("Credit_Advice_Prepared").value;
           //var Credit_Advice_Details = document.getElementById("Credit_Advice_Details").value;
           //var Credit_Note_Prepared = document.getElementById("Credit_Note_Prepared").value;
           //var Commission_Vendor_Name = document.getElementById("Commission_Vendor_Name").value;
           //var Vendor_Code = document.getElementById("Vendor_Code").value;

           var model = {
               "FromNo": FromNo,
               "OCF_No": OCF_No,
               "Invoice_No": Invoice_No,
               "PI_No": PI_No,
               "ActualCommission": ActualCommission,
               "Claimform_Received": Claimform_Received,
               "CommissionInvoice_Received": CommissionInvoice_Received,
               "CommissionworkingsenttoVendor_Employee": CommissionworkingsenttoVendor_Employee,
               "Credit_Advice_Prepared": Credit_Advice_Prepared,
               "Credit_Advice_Details": Credit_Advice_Details,
               "Credit_Note_Prepared": Credit_Note_Prepared,
               "CreditNotePreparedNo": CreditNotePreparedNo,
               "Commission_Vendor_Name": Commission_Vendor_Name,
               "Vendor_Code": Vendor_Code
           }
                   var urlRequest = '@Url.Action("GetDataUpadateDetails", "Commissiontracker")';
           $.ajax({
               url: urlRequest,
               type: 'POST',
              contentType: 'application/json',
               data: JSON.stringify({
                   "FromNo": FromNo,
                   "OCF_No": OCF_No,
                   "Invoice_No": Invoice_No,
                   "PI_No": PI_No,
                   "ActualCommission": ActualCommission,
                   "Claimform_Received": Claimform_Received,
                   "CommissionInvoice_Received": CommissionInvoice_Received,
                   "CommissionworkingsenttoVendor_Employee": CommissionworkingsenttoVendor_Employee,
                   "Credit_Advice_Prepared": Credit_Advice_Prepared,
                   "Credit_Advice_Details": Credit_Advice_Details,
                   "Credit_Note_Prepared": Credit_Note_Prepared,
                   "Commission_Vendor_Name": Commission_Vendor_Name,
                   "Vendor_Code": Vendor_Code}),
              success: function (data) {
                           if (data.Status == true) {
                               alert('Record Update successfully...');
                           //    document.getElementById("lnkRefreshDetails").click();
                           }
                           else {
                               alert('Not Record Update successfully...');
                           }
                       },
                       error: function (xhr, ret, e) {
                       }
                   });
               });
        $('#lnkRefreshDetails').click(function (e) {
            e.preventDefault();
              $('#PI_No,#CustomerName,#CommissionRate,#OCF_No,#Commission_Vendor_Name,#TentativeCommBasic_Amt,#Invoice_No,#CommissionType,#SalesPerson_Name,#Credit_Advice_Details').val('');
              $('#INV_Dates,#Claimform_Received,#CommissionworkingsenttoVendor_Employee,#CommissionInvoice_Received,#Credit_Advice_Prepared,#Credit_Note_Prepared').val('')
              $('#TaggedOnPI,#TaggedOnOCF,#TaggedAfterInvoice').prop('checked', false);
                });
        $('#lnkExitDetails').click(function () {
            var newPageUrl = "/TrackerSystem/Login";  // The URL where you want to redirect
            window.location.href = newPageUrl;
        });

        @*$(document).ready(function () {
            $('#DataShowPI,#DataShowList,#DataShowPreMarketing,#DataShowCommercial,#DataShowPostMarketing,#DataShowLogistics,#DataShowAccounts').hide();
            $('#DataShowPI').show();
            var ObjectType = "";
            var urlRequest = '@Url.Action("GetGridListComForPIStatus", "Common")'; // MVC action URL
            $('#loadingMessage').show();         // Show spinner
            $('#TblPIListInfo').hide();
            $.ajax({
                url: urlRequest,
                type: 'GET',
                data:
                {
                    ObjectType
                },
                success: function (data) {

                    var totalRecords = data.length;
                    var pageLength = 10;
                    var totalPages = Math.ceil(totalRecords / pageLength);
                    var startRecord = 1;
                    var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                    $('#TblPIListInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                    if ($.fn.dataTable.isDataTable('#TblPIListInfo')) {
                        $('#TblPIListInfo').DataTable().destroy();
                    }
                    var rows = '';
                    for (var i = 0; i < data.length; i++) {
                        var item = data[i];

                        var PI_noTooltip = item.PI_No;
                        var OCF_NoTooltip = item.OCF_No;
                        var Invoice_NoTooltip = item.Invoice_No;
                        var PI_DateTooltip = item.PI_Date;
                        var CustomerNameTooltip = item.CustomerName;
                        var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                        var CommissionTypeTooltip = item.CommissionType;
                        var CommissionRateTooltip = item.CommissionRate;
                        var SalesPerson_NameTooltip = item.SalesPerson_Name;
                        var TaggedOnPITooltip = item.TaggedOnPI;
                        var TaggedOnOCFTooltip = item.TaggedOnOCF;
                        var TaggedOnINVTooltip = item.TaggedOnINV;
                        rows += '<tr>';
                        rows += '<td  >' + item.SrNo + '</td>';
                        rows += '<td title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                        rows += '<td title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                        rows += '<td title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                        var formattedClaimDate1 = formatDateToShortDMY(item.PI_Date);
                        rows += '<td title="' + PI_DateTooltip + '">' + formattedClaimDate1 + '</td>';
                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';

                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
                        rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;"  title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                        rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                        rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';
                        rows += '<td title="' + TaggedOnINVTooltip + '" style="text-align:center;">' + (item.TaggedOnINV ? 'Yes' : '--') + '</td>';


                        rows += '</tr>';
                    }

                    $('.Infotbody').html(rows);
                    $('#loadingMessage').hide();
                    $('#TblPIListInfo').show();
                    var table = $('#TblPIListInfo').DataTable({
                        "paging": true,
                        "searching": true,
                        "ordering": true,
                        "lengthMenu": [10,15,20, 25, 50, 100],
                        "pageLength": 10,
                        "language": {
                            emptyTable: "No Data Found"
                        },
                        "initComplete": function (settings, json) {
                            $('#TblPIListInfo_filter').hide();
                        }
                    });
                    $('#TblPIListInfo thead').on('keyup change', '.column-search', function () {
                        var columnIndex = $(this).data('column');
                        var searchValue = this.value;
                        table.column(columnIndex).search(searchValue).draw();
                    });
                    $('[data-toggle="tooltip"]').tooltip();
                }
            });
        });*@

          $(document).ready(function () {
              $('#DataShowList,#DataShowPreMarketing,#DataShowCommercial,#DataShowPostMarketing,#DataShowLogistics,#DataShowAccounts').hide();

                $('#DataShowList').show();
              var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
              $('#invoiceNoSearchSectionList').hide();
              var selectedSearchType = $('#searchType').val();


                    $('#loadingMessage1').show();         // Show spinner
                        $('#TblcommissionInfo').hide();
                        $.ajax({
                            url: urlRequest1,
                            type: 'GET',
                            data: { SearchType: selectedSearchType },
                            success: function (data) {

                                var totalRecords = data.length;
                                var pageLength = 20;
                                var totalPages = Math.ceil(totalRecords / pageLength);
                                var startRecord = 1;
                                var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                                $('#TblcommissionInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                                if ($.fn.dataTable.isDataTable('#TblcommissionInfo')) {
                                    $('#TblcommissionInfo').DataTable().destroy();
                                }
                                var rows = '';
                                for (var i = 0; i < data.length; i++) {
                                    var item = data[i];

                                        var siTooltip = item.SrNo;
                                        var PI_noTooltip = item.PI_No;
                                        var OCF_NoTooltip = item.OCF_No;
                                        var Invoice_NoTooltip = item.Invoice_No;
                                        var Invoice_DateTooltip = item.INV_Dates;
                                        var CustomerNameTooltip = item.CustomerName;
                                        var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                                        var CommissionTypeTooltip = item.CommissionType;
                                        var CommissionRateTooltip = item.CommissionRate;
                                        var SalesPerson_NameTooltip = item.SalesPerson_Name;
                                        var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                                        var TaggedOnPITooltip = item.TaggedOnPI;
                                        var TaggedOnOCFTooltip = item.TaggedOnOCF;
                                        var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                                        var Claimform_ReceivedTooltip = item.Claimform_Received;
                                        var CommissionworkingsenttoVendor_EmployeeTooltip = item.CommissionworkingsenttoVendor_Employee;
                                        var CommissionInvoice_ReceivedTooltip = item.CommissionInvoice_Received;
                                        var Credit_Note_PreparedTooltip = item.Credit_Note_Prepared;
                                        var CreditAdviceDetailsTooltip = item.Credit_Advice_Details;
                                        var Vendor_CodeTooltip = item.Vendor_Code;
                                        var ActualCommissionTooltip = item.ActualCommission;
                                    var CreditAdvicePreparedTooltip = item.Credit_Advice_Prepared;
                                    let CreditNotePreparedNoTooltip = item.CreditNotePreparedNo
                                    let creditnotepreparedvalue = item.Credit_Note_Prepared
                                    let rowClass = '';
                                    debugger
                                    if (creditnotepreparedvalue && creditnotepreparedvalue.trim() !== '') {
                                        rowClass = 'tr-green'; // make it green if has value
                                    }
                                    else { rowClass = ''; }
                                    rows += `<tr class="${rowClass}">`;
                                        rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                                        rows += '<td class="PI_No" title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                                        rows += '<td class="OCF_No" title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                                        rows += '<td class="Invoice_No" title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                                        //  var formattedClaimDate5 = formatDateToShortDMY(item.INV_Dates);
                                        rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                                        // rows += '<td  title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
                                        rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                                        rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;"  title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                                        rows += '<td style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                                        rows += '<td style="text-align: end;" title="' + ActualCommissionTooltip + '">' + item.ActualCommission + '</td>';
                                        rows += '<td title="' + CommissionworkingsenttoVendor_EmployeeTooltip + '">' + item.CommissionworkingsenttoVendor_Employee + '</td>';
                                        rows += '<td title="' + CommissionInvoice_ReceivedTooltip + '">' + item.CommissionInvoice_Received + '</td>';
                                        rows += '<td title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
                                        rows += '<td title="' + CreditAdvicePreparedTooltip + '">' + item.Credit_Advice_Prepared + '</td>';
                                    rows += '<td class="" title="' + CreditAdviceDetailsTooltip + '">' + item.Credit_Advice_Details + '</td>';
                                    rows += '<td class="" title="' + CreditNotePreparedNoTooltip + '">' + item.CreditNotePreparedNo + '</td>';
                                        rows += '<td title="' + Credit_Note_PreparedTooltip + '">' + item.Credit_Note_Prepared + '</td>';
                                        rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                                        rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                                        rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

                                        //     var formattedClaimDate1 = formatDateToShortDMY(item.Claimform_Received);


                                        // var formattedClaimDate = formatDateToShortDMY(item.CommissionworkingsenttoVendor_Employee);


                                        // var formattedClaimDate2 = formatDateToShortDMY(item.CommissionInvoice_Received);



                                        rows += '<td title="' + Vendor_CodeTooltip + '">' + item.Vendor_Code + '</td>';
                                        rows += '</tr>';
                                }

                                $('.commissionInfotbody').html(rows);
                                $('#invoiceNoSearchSectionList').show();


                                $('#loadingMessage1').hide();
                                $('#TblcommissionInfo').show();
                                var table = $('#TblcommissionInfo').DataTable({
                                    paging: true,
                                    searching: true,
                                    ordering: true,
                                    lengthMenu: [20, 25, 50, 100],
                                    pageLength: 20,
                                    language: {
                                        emptyTable: "No Data Found"
                                    },
                                    initComplete: function () {
                                        moveLengthDropdown();
                                    },
                                    drawCallback: function () {
                                        moveLengthDropdown();
                                    }
                                });

                                function moveLengthDropdown() {

                                    $('#TblcommissionInfo_filter').hide();
                                    // Only move if it's still inside the original wrapper

                                    var $length = $('#TblcommissionInfo_wrapper').find('#TblcommissionInfo_length');  // Get the length menu
                                    var $target = $('#commissionpage');  // Target container to move the length menu to

                                    if ($length.length && $target.length) {  // Ensure both are present in DOM
                                        // Remove existing length menu from target if already there
                                        $target.find('#TblcommissionInfo_length').remove();

                                        // Append and style the length menu
                                        $length.appendTo($target).css({
                                            'margin-top': '5px',
                                            'text-align': 'end',
                                            'display': 'inline-block'
                                        });
                                    } else {
                                        console.warn("Either #TblcommissionInfo_length or #commissionpage is missing.");
                                    }
                                }
                                $('#TblcommissionInfo thead').on('keyup change', '.column-search', function () {

                                    var columnIndex = $(this).data('column');
                                    var searchValue = this.value;
                                    table.column(columnIndex).search(searchValue).draw();
                                });
                            }


                        });
                    $('[data-toggle="tooltip"]').tooltip();




            });
        //$('#TblPIListInfo tbody').on('dblclick', 'tr', function () {

        //    autoClickTab('#lnkDetail');
        //    var table = $('#TblPIListInfo').DataTable();
        //    var rowData = table.row(this).data(); // Get the row data
        //    $("#PI_No").val(rowData[1]);
        //    $("#OCF_No").val(rowData[2]);
        //    $("#Invoice_No").val(rowData[3]);
        //    $("#PI_Date").val(rowData[4]);
        //    $("#CustomerName").val(rowData[5]);
        //    $("#Commission_Vendor_Name").val(rowData[6]);
        //    $("#CommissionType").val(rowData[7]);
        //    $("#CommissionRate").val(rowData[8]);
        //    $("#SalesPerson_Name").val(rowData[9]);
        //    if (rowData[10] == "Yes") {
        //        $("#TaggedOnPI").prop("checked", true);
        //    }
        //    else {
        //        $("#TaggedOnPI").prop("checked", false);
        //    }
        //    if (rowData[11] == "Yes") {
        //        $("#TaggedOnOCF").prop("checked", true);
        //    }
        //    else {
        //        $("#TaggedOnOCF").prop("checked", false);
        //    }
        //    if (rowData[12] == "Yes") {
        //        $("#TaggedOnINV").prop("checked", true);
        //    }
        //    else {
        //        $("#TaggedOnINV").prop("checked", false);
        //    }

        //});

        $('#TblcommissionInfo tbody').on('dblclick', 'tr', function () {
            debugger
            autoClickTab('#lnkDetail');
            var table = $('#TblcommissionInfo').DataTable();
            var rowData = table.row(this).data(); // Get the row data
            console.log(rowData);
            $("#PI_No").val(rowData[1]);
            $("#OCF_No").val(rowData[2]);
            $("#Invoice_No").val(rowData[3]);
            $("#INV_Dates").val(rowData[4]);
            $("#CustomerName").val(rowData[5]);
            $("#Commission_Vendor_Name").val(rowData[6]);
            $("#CommissionType").val(rowData[7]);
            $("#CommissionRate").val(rowData[8]);
            $("#SalesPerson_Name").val(rowData[9]);
            $("#TentativeCommBasic_Amt").val(rowData[10]);
            //   $("#ActualCommission").val(rowData[11]);
            var actualCommission = rowData[11];

            if (actualCommission !== null && actualCommission !== undefined && actualCommission != 0) {
                // Disable the textbox if value is NOT 0 and NOT null
                $("#ActualCommission").val(actualCommission).prop("disabled", true);
            } else {
                // Enable the textbox if value is 0 or null
                $("#ActualCommission").val('').prop("disabled", false);
            }
            $("#CommissionworkingsenttoVendor_Employee").val(rowData[12]);
            $("#CommissionInvoice_Received").val(rowData[13]);
            $("#Claimform_Received").val(rowData[14]);

            $("#Credit_Advice_Prepared").val(rowData[15]);
            $("#Credit_Advice_Details").val(rowData[16]);
            $("#CreditNotePreparedNo").val(rowData[17]);



            $("#Credit_Note_Prepared").val(rowData[18]);
            if (rowData[19] == "Yes") {
                $("#TaggedOnPI").prop("checked", true);
            }
            else {
                $("#TaggedOnPI").prop("checked", false);
            }
            //  $("#TaggedOnPI").val(rowData[11]);
            if (rowData[20] == "Yes") {
                $("#TaggedOnOCF").prop("checked", true);
            }
            else {
                $("#TaggedOnOCF").prop("checked", false);
            }
            if (rowData[21] == "Yes") {
                $("#TaggedAfterInvoice").prop("checked", true);
            }
            else {
                $("#TaggedAfterInvoice").prop("checked", false);
            }

            $("#Vendor_Code").val(rowData[22]);
        });

        $('#TblcommissionInfo tbody,  #TblPreMarketingInfo tbody,#TblCommercialInfo tbody,#TblPostMarketingInfo tbody,#TblLogisticsInfo tbody,#TblAccountsInfo tbody').on('click', 'tr', function () {
            var table = $(this).closest('table');
            table.find('tbody tr').removeClass('selected');
            $(this).addClass('selected');
        });


      @*  var clickedLink = document.getElementById("CommissionTrackerlink-id");
      //  margin - top: 2px;
        clickedLink.style.marginTop = "15px";
        clickedLink.style.width = "220px";
        clickedLink.style.border = "2px solid rgb(223, 227, 230)";
        clickedLink.style.borderRadius = "8px";
        clickedLink.style.backgroundColor = "rgb(230, 240, 255)";
        clickedLink.style.color = "rgb(1, 41, 112)";
        clickedLink.style.fontFamily = "'Segoe UI', Roboto, sans-serif";
        clickedLink.style.fontSize = "16px";
        clickedLink.style.fontWeight = "600";
        clickedLink.style.textAlign = "center";
        clickedLink.style.textDecoration = "none";
        clickedLink.style.boxShadow = "0px 4px 8px rgba(0, 0, 0, 0.1)";
        clickedLink.style.transition = "0.3s"; *@    $(document).on('change', '.All-CheckedFacyPre', function () {
            if ($('.All-CheckedFacyPre:checked').length == 1) {

                var rowElement = $(this).closest('tr');
                $('#Claim_form_DatepreMar').val(rowElement.find('.CO_Claimform_Received').text());

            }
            else {
                $('#Claim_form_DatepreMar').val('');
            }
        });
        $(document).on('change', '.All-CheckedFacyPost', function () {
            if ($('.All-CheckedFacyPost:checked').length == 1) {

                var rowElement = $(this).closest('tr');
                $('#CCOCredit_Note_Prepared').val(rowElement.find('.CO_Credit_Note_Prepared').text());

            }
            else {
                $('#CCOCredit_Note_Prepared').val('');
            }
        });
        $(document).on('change', '.All-CheckedFacyCom', function () {
            if ($('.All-CheckedFacyCom:checked').length == 1) {

                var rowElement = $(this).closest('tr');
                $('#CCO_Commissionsenttovendor').val(rowElement.find('.CO_Commissionsenttovendor').text());
                $('#CCO_Remarks').val(rowElement.find('.CO_Remarks').text());

            }
            else {
                $('#Commission_working_DatePost').val('');
                $('#Remarks').val('');
            }
        });
        $(document).on('change', '.All-CheckedFacy', function () {
            if ($('.All-CheckedFacy:checked').length == 1) {

                var rowElement = $(this).closest('tr');
                $('#CCOCredit_Note_Prepared').val(rowElement.find('.CO_Credit_Note_Prepared').text());

            }
            else {
                $('#CCOCredit_Note_Prepared').val('');
            }
        });
        $(document).on('change', '.All-CheckedFacyLog', function () {
            if ($('.All-CheckedFacyLog:checked').length == 1) {

                var rowElement = $(this).closest('tr');
                $('#CCOCredit_Advice_Prepared').val(rowElement.find('.CO_Credit_Advice_Prepared').text());
                $('#CCOCredit_Advice_Details').val(rowElement.find('.CO_Credit_Advice_details').text());

            }
            else {
                $('#CCOCredit_Advice_Details').val('');
                $('#CCOCredit_Advice_Prepared').val('');
            }
        });
    });
    function showDate(inputElement) {
        // Destroy any existing picker before creating a new one
        if (window.activeDatePicker) {
            window.activeDatePicker.destroy();
        }

        // Create the date picker
        var datePicker = Ext.create('Ext.picker.Date', {
            renderTo: Ext.getBody(),
            floating: true,
            format: 'd/m/y',
            listeners: {
                select: function (picker, date) {
                    inputElement.value = Ext.Date.format(date, 'd/m/y'); // Full year format
                    picker.hide();
                },
                hide: function () {
                    picker.destroy(); // Clean up after hiding
                }
            }
        });

        // Get the input element position
        var inputRect = inputElement.getBoundingClientRect();
        var pickerHeight = 200; // Approx height of the datepicker in px
        var scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        var scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;

        // Position above the input
        var x = inputRect.left + scrollLeft;
        var y = inputRect.top + scrollTop - pickerHeight - 10; // 10px margin above input

        datePicker.showAt(x, y);
        window.activeDatePicker = datePicker;

        // Hide if clicked outside
        Ext.getBody().on('click', function onClick(event) {
            if (!datePicker.el.contains(event.target) && event.target !== inputElement) {
                datePicker.hide();
                Ext.getBody().un('click', onClick); // Remove listener once used
            }
        });
    }

    function showDatePicker(inputElement) {
        var datePicker1 = Ext.create('Ext.picker.Date', {
            renderTo: Ext.getBody(),
            floating: true,
            format: 'd/m/Y',  // Set the format you want here
            listeners: {
                // Listener for date selection
                select: function (picker, date) {
                    // Set the selected date in the input element
                    inputElement.value = Ext.Date.format(date, 'd/m/y');
                    // Hide the picker after selection
                    picker.hide();
                },
                // Listener for when the picker is hidden
                hide: function () {
                    // Optionally, you can do something here when picker is hidden
                },
                // Optional: auto-close when input loses focus
                blur: function () {
                    datePicker1.hide();
                }
            }
        });

        // Get the position of the input element
        var inputPosition = inputElement.getBoundingClientRect();
        var x = inputPosition.left -200;
        var y = inputPosition.top + inputPosition.height;

        // Show the picker at the calculated position
        datePicker1.showAt(x, y);
        Ext.getBody().on('click', function (event) {
            // Check if the click is outside the picker and the input element
            if (!datePicker1.el.contains(event.target) && event.target !== inputElement) {
                datePicker1.hide();
            }
        });
    }
    function formatDateToShortDMY(dateString) {
        if (!dateString) return '';

        const parts = dateString.split('/');
        if (parts.length !== 3) return '';

        const day = String(parseInt(parts[0], 10)).padStart(2, '0');
        const month = String(parseInt(parts[1], 10)).padStart(2, '0');
        const year = parts[2].length === 4 ? parts[2].slice(-2) : parts[2];

        return `${day}/${month}/${year}`;
    }

       function GetData() {
        $('#DataShowPI,#DataShowList,#DataShowPreMarketing,#DataShowCommercial,#DataShowPostMarketing,#DataShowLogistics,#DataShowAccounts').hide();
        //if (lnkList.className == "HeaderFont active") {

        //}
             if (lnkPreMarketing.className == "HeaderFont active")
             {
                 $(document).ready(function () {
                $('#DataShowPreMarketing').show();
                var ObjectType = "PreMarketing";
               @* var urlRequest = '@Url.Action("GetGridComForList", "Commissiontracker")'; // MVC action URL
                if (urlRequest != null) {*@
                var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
                     $('#invoiceNoSearchSectionpre').hide();
               @* $('#selecte').hide();
                $('#selected').hide();
                $('#selectedpre').hide();
                $('#clearAndLengthWrapper').hide();
                $('#lengthSelectorWrapper').hide();*@
                     var selectedSearchType = $('#searchType').val();
                     $('#rowdspre').hide();
                    $('#loadingMessage2').show();         // Show spinner
                    $('#TblPreMarketingInfo').hide();
                    $.ajax({
                        url: urlRequest1,
                        type: 'GET',
                        data:
                        {
                            ObjectType: ObjectType,
                            SearchType: selectedSearchType
                        },
                        success: function (data) {

                            var totalRecords = data.length;
                            var pageLength = 20;
                            var totalPages = Math.ceil(totalRecords / pageLength);
                            var startRecord = 1;
                            var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                            $('#TblPreMarketingInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                            if ($.fn.dataTable.isDataTable('#TblPreMarketingInfo')) {
                                $('#TblPreMarketingInfo').DataTable().destroy();
                            }
                            var rows = '';
                            for (var i = 0; i < data.length; i++) {
                                var item = data[i];

                                var siTooltip = item.SrNo;
                                var PI_noTooltip = item.PI_No;
                                var OCF_NoTooltip = item.OCF_No;
                                var Invoice_NoTooltip = item.Invoice_No;
                                var Invoice_DateTooltip = item.INV_Dates;
                                var CustomerNameTooltip = item.CustomerName;
                                var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                                var CommissionTypeTooltip = item.CommissionType;
                                var SalesPerson_NameTooltip = item.SalesPerson_Name;
                                var CommissionRateTooltip = item.CommissionRate;
                                var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                                var TaggedOnPITooltip = item.TaggedOnPI;
                                var TaggedOnOCFTooltip = item.TaggedOnOCF;
                                var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                                var Claimform_ReceivedTooltip = item.Claimform_Received;
                                var FromNoTooltip = item.FromNo;
                                var VendorNoTooltip = item.Vendor_Code;

                                rows += '<tr >';
                                rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                                rows += '<td class="PI" title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                                rows += '<td class="OCF" title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                                rows += '<td class="Invoice" title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                                /*var formattedClaimDate5 = formatDateToShortDMY(item.INV_Dates);
                                rows += '<td title="' + Invoice_DateTooltip + '">' + formattedClaimDate5 + '</td>';*/
                               rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                                rows += '<td  style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" class="VendorName" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;"   title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                                rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                                rows += '<td  style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                                rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                                rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                                rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

                                rows += '<td style="text-align: center;"><input type="checkbox" Id="CheckboxPre" class="row-checkbox All-CheckedFacyPre" /></td>';


                                if (item.Claimform_Received) {
                                    //var formattedClaimDate = formatDateToShortDMY(item.Claimform_Received);
                                    rows += '<td  title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
                                } else {
                                    rows += '<td  style="text-align: center;" class="CO_Claimform_Received" title="' + Claimform_ReceivedTooltip + '">' + (item.Claimform_Received || '<input type="text" style="width: 71px;  text-align: center;" onclick="showDatePicker(this);" id="CCO_Claimform_Received" class="input-box TextSize"  />') + '</td>';

                                   @* rows += '<td title="' + Claimform_ReceivedTooltip + '">';
                                    rows += '@Html.TextBoxFor(model => model.Claimform_Received, new { @class = "form-control", @id = "CCO_Claimform_Received", style = "font-size: 14px !important;width: 90%;" })';
                                    rows += '</td>';*@
                                }
                                rows += '<td class="FromNo" style="display: none;" title="' + FromNoTooltip + '">' + item.FromNo + '</td>';
                                rows += '<td class="Vendor_Code" style="display: none;" title="' + VendorNoTooltip + '">' + item.Vendor_Code + '</td>';
                                rows += '</tr>';
                            }

                            $('.PreMarketingInfotbody').html(rows);
                            $('#invoiceNoSearchSectionpre').show();
                           @* $('#selecte').show();
                            $('#selected').show();
                            $('#selectedpre').show();
                            $('#clearAndLengthWrapper').show();
                            $('#lengthSelectorWrapper').show();*@
                            $('#rowdspre').show();
                            $('#loadingMessage2').hide();
                            $('#TblPreMarketingInfo').show();
                            var table = $('#TblPreMarketingInfo').DataTable({
                                paging: true,
                                searching: true,
                                ordering: true,
                                "lengthMenu": [20, 25, 50, 100],
                                "pageLength": 20,
                                language: {
                                    emptyTable: "No Data Found"
                                },
                                initComplete: function () {
                                    moveLengthDropdown();
                                },
                                drawCallback: function () {
                                    moveLengthDropdown();
                                }
                            });

                            function moveLengthDropdown() {

                                $('#TblPreMarketingInfo_filter').hide();

                                // Only move if it's still inside the original wrapper
                                var $length = $('#TblPreMarketingInfo_wrapper').find('#TblPreMarketingInfo_length');  // Get the length menu
                                var $target = $('#lengthSelectorWrapper');  // Target container to move the length menu to

                                if ($length.length && $target.length) {  // Ensure both are present in DOM
                                    // Remove existing length menu from target if already there
                                    $target.find('#TblPreMarketingInfo_length').remove();

                                    // Append and style the length menu
                                    $length.appendTo($target).css({
                                        'margin-top': '-3px',
                                        'text-align': 'end',
                                        'display': 'inline-block'
                                    });
                                } else {
                                    console.warn("Either #TblPreMarketingInfo_length or #lengthSelectorWrapper is missing.");
                                }
                            }



                            $('#TblPreMarketingInfo thead').on('keyup change', '.column-search', function () {
                                var columnIndex = $(this).data('column');
                                var searchValue = this.value;
                                table.column(columnIndex).search(searchValue).draw();
                            });

                            $('[data-toggle="tooltip"]').tooltip();
                        }
                    });

                 });
             }
          else if (lnkCommercial.className == "HeaderFont active")
 {
      $(document).ready(function () {
        var ObjectType = "Commercial";
          $('#DataShowCommercial').show();

   @*  var urlRequest = '@Url.Action("GetGridComForList", "Commissiontracker")'; // MVC action URL
     if (urlRequest != null) {*@
         var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
          $('#loadingMessage3').show();// Show spinner
          $('#Commercialh').hide();
          $('#commercialpage').hide();
          $('#Commercialf').hide();
          $('#TblCommercialInfo').hide();
          var selectedSearchType = $('#searchType').val();
         $.ajax({
             url: urlRequest1,
             type: 'GET',
             data:
             {
                 ObjectType: ObjectType,
                 SearchType: selectedSearchType
             },
             success: function (data) {

                 var totalRecords = data.length;
                 var pageLength = 20;
                 var totalPages = Math.ceil(totalRecords / pageLength);
                 var startRecord = 1;
                 var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                 $('#TblCommercialInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                 if ($.fn.dataTable.isDataTable('#TblCommercialInfo')) {
                     $('#TblCommercialInfo').DataTable().destroy();
                 }
                 var rows = '';
                 for (var i = 0; i < data.length; i++) {
                     var item = data[i];

                     var siTooltip = item.SrNo;
                     var PI_noTooltip = item.PI_No;
                     var OCF_NoTooltip = item.OCF_No;
                     var Invoice_NoTooltip = item.Invoice_No;
                     var Invoice_DateTooltip = item.INV_Dates;
                     var CustomerNameTooltip = item.CustomerName;
                     var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                     var CommissionTypeTooltip = item.CommissionType;
                     var SalesPerson_NameTooltip = item.SalesPerson_Name;
                     var CommissionRateTooltip = item.CommissionRate;
                     var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                     var TaggedOnPITooltip = item.TaggedOnPI;
                     var TaggedOnOCFTooltip = item.TaggedOnOCF;
                     var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                     var Claimform_ReceivedTooltip = item.Claimform_Received;
                     var CommissionworkingsenttoVendorTooltip = item.CommissionworkingsenttoVendor_Employee;
                     var RemarksTooltip = item.Remarks;
                     var FreightAmtTooltip = item.FreightAmt;
                     var FreightBillNoTooltip = item.FreightBillNo;
                     var FreightBillDateTooltip = item.FreightBillDate;
                     var FromNoTooltip = item.FromNo;
                     var VendorNoTooltip = item.Vendor_Code;
                     var ActualCommissionTooltip = item.ActualCommission;
                     rows += '<tr>';
                     rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                     rows += '<td class="PI_No" title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                     rows += '<td class="OCF_No" title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                     rows += '<td class="Invoice_No" title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                    // var formattedClaimDate5 = formatDateToShortDMY(item.INV_Dates);
                     rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                     rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                     rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" class="Commission_Vendor_Name" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                     rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';

                     rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;" title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                     rows += '<td style="text-align: end; style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;"" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                     rows += '<td style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                     rows += '<td  style="text-align: center;" class="CO_ActualCommission" title="' + ActualCommissionTooltip + '">' + (item.ActualCommission || '<input type="text" style="width: 71px;  text-align: center;" id="CCO_ActualCommission" class="input-box TextSize"  />') + '</td>';

                     rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                     rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                     rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

                     rows += '<td class="Claimform_Received" title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
                     rows += '<td style="text-align: center;"><input type="checkbox" Id="CheckboxCom" class="row-checkbox All-CheckedFacyCom" /></td>';

                     rows += '<td  style="text-align: center;" class="CO_Commissionsenttovendor" title="' + CommissionworkingsenttoVendorTooltip + '">' + (item.CommissionworkingsenttoVendor_Employee || '<input   type="text" style="width: 71px;  text-align: center;" id="CCO_Commissionsenttovendor" class="input-box TextSize" onclick="showDatePicker(this);" />') + '</td>';
                     rows += '<td  style="text-align: center;" class="CO_Remarks" title="' + RemarksTooltip + '">' + (item.Remarks || '<input type="text" style="width: 71px;  text-align: center;" id="CCO_Remarks" class="input-box TextSize"  />') + '</td>';
                     //rows += '<td title="' + FreightAmtTooltip + '">' + item.FreightAmt + '</td>';
                     //rows += '<td title="' + FreightBillNoTooltip + '">' + item.FreightBillNo + '</td>';
                     //rows += '<td title="' + FreightBillDateTooltip + '">' + item.FreightBillDate + '</td>';
                     rows += '<td class="FromNo" style="display: none;" title="' + FromNoTooltip + '">' + item.FromNo + '</td>';
                     rows += '<td class="Vendor_Code" style="display: none;" title="' + VendorNoTooltip + '">' + item.Vendor_Code + '</td>';
                     rows += '</tr>';



                 }

                 $('.CommercialInfotbody').html(rows);
                 $('#Commercialh').show();
                 $('#commercialpage').show();
                 $('#Commercialf').show();
                 $('#loadingMessage3').hide();
                 $('#TblCommercialInfo').show();
                 var table = $('#TblCommercialInfo').DataTable({
                     paging: true,
                     searching: true,
                     ordering: true,
                     "lengthMenu": [20, 25, 50, 100],
                     "pageLength": 20,
                     language: {
                         emptyTable: "No Data Found"
                     },
                     initComplete: function () {
                         moveLengthDropdown();
                     },

                 });

                 function moveLengthDropdown() {

                     $('#TblCommercialInfo_filter').hide();

                     // Only move if it's still inside the original wrapper
                     var $length = $('#TblCommercialInfo_wrapper').find('#TblCommercialInfo_length');  // Get the length menu
                     var $target = $('#commercialpage');  // Target container to move the length menu to

                     if ($length.length && $target.length) {  // Ensure both are present in DOM
                         // Remove existing length menu from target if already there
                         $target.find('#TblCommercialInfo_length').remove();

                         // Append and style the length menu
                         $length.appendTo($target).css({
                             'margin-top': '-3px',
                             'text-align': 'end',
                             'display': 'inline-block'
                         });
                     } else {
                         console.warn("Either #TblCommercialInfo_length or #commissionpage is missing.");
                     }
                 }
                 $('#TblCommercialInfo thead').on('keyup change', '.column-search', function () {
                     var columnIndex = $(this).data('column');
                     var searchValue = this.value;
                     table.column(columnIndex).search(searchValue).draw();
                 });
                 $('[data-toggle="tooltip"]').tooltip();
                 $('[title]').tooltip();


             }
         });

      });
 }
                      else if (lnkPostMarketing.className == "HeaderFont active")
             {

                 $(document).ready(function () {
                $('#DataShowPostMarketing').show();
                var ObjectType = "PostMarketing";
               @* var urlRequest = '@Url.Action("GetGridComForList", "Commissiontracker")'; // MVC action URL
                if (urlRequest != null) {*@
                var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
                $('#postp').hide();
                     var selectedSearchType = $('#searchType').val();
                    $('#loadingMessage4').show();         // Show spinner
                     $('#TblPostMarketingInfo').hide();

                    $.ajax({
                        url: urlRequest1,
                        type: 'GET',
                        data:
                        {
                            ObjectType: ObjectType,
                            SearchType: selectedSearchType
                        },
                        success: function (data) {

                            var totalRecords = data.length;
                            var pageLength = 20;
                            var totalPages = Math.ceil(totalRecords / pageLength);
                            var startRecord = 1;
                            var endRecord = totalRecords < pageLength ? totalRecords : pageLength;
                            $('#TblPostMarketingInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');

                           if ($.fn.dataTable.isDataTable('#TblPostMarketingInfo')) {
                                $('#TblPostMarketingInfo').DataTable().destroy();
                            }

                            var rows = '';
                            for (var i = 0; i < data.length; i++) {
                                var item = data[i];

                                var siTooltip = item.SrNo;
                                var PI_noTooltip = item.PI_No;
                                var OCF_NoTooltip = item.OCF_No;
                                var Invoice_NoTooltip = item.Invoice_No;
                                var Invoice_DateTooltip = item.INV_Dates;
                                var CustomerNameTooltip = item.CustomerName;
                                var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                                var CommissionTypeTooltip = item.CommissionType;
                                var SalesPerson_NameTooltip = item.SalesPerson_Name;
                                var CommissionRateTooltip = item.CommissionRate;
                                var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                                var TaggedOnPITooltip = item.TaggedOnPI;
                                var TaggedOnOCFTooltip = item.TaggedOnOCF;
                                var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                                var Claimform_ReceivedTooltip = item.Claimform_Received;
								  var CommissionworkingsenttoVendor_EmployeeTooltip = item.CommissionworkingsenttoVendor_Employee;
                                var CommissionInvoice_ReceivedTooltip = item.CommissionInvoice_Received;
                                var FromNoTooltip = item.FromNo;
                                var VendorNoTooltip = item.Vendor_Code;
                                var ActualCommissionTooltip = item.ActualCommission;

                                rows += '<tr >';
                                rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                                rows += '<td class="PI" title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                                rows += '<td class="OCF" title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                                rows += '<td class="Invoice" title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                  /*              var formattedDate5 = formatDateToShortDMY(item.INV_Dates);
                                rows += '<td title="' + Invoice_DateTooltip + '">' + formattedDate5 + '</td>';*/
                                rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                                rows += '<td  style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" class="VendorName" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;"   title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                                rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                                rows += '<td  style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                                rows += '<td style="text-align: end;" title="' + ActualCommissionTooltip + '">' + item.ActualCommission + '</td>';
                                rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                                rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                                rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';
 rows += '<td style="text-align: center;" class="CO_Claimform_Received" title="' + Claimform_ReceivedTooltip + '">' + (item.Claimform_Received || '<input type="text" style="width:71px; text-align: center;" id="CCO_Claimform_Received" class="input-box TextSize" onclick="showDatePicker(this);" />') + '</td>';
                               // var formatted2 = formatDateToShortDMY(item.CommissionworkingsenttoVendor_Employee);
                                rows += '<td title="' + CommissionworkingsenttoVendor_EmployeeTooltip + '">' + item.CommissionworkingsenttoVendor_Employee + '</td>';

                                rows += '<td style="text-align: center;"><input type="checkbox" Id="CheckboxPost" class="row-checkbox All-CheckedFacyPost" /></td>';
                                rows += '<td   style="text-align: center;" class="CO_CommissionInvoice_Received" title="' + CommissionInvoice_ReceivedTooltip + '">' + (item.CommissionInvoice_Received || '<input  style="width: 71px;  text-align: center;" type="text" id="CCO_CommissionInvoice_Received" class="input-box TextSize" onclick="showDatePicker(this);" />') + '</td>';




                                rows += '<td class="FromNo" style="display: none;" title="' + FromNoTooltip + '">' + item.FromNo + '</td>';
                                rows += '<td class="Vendor_Code" style="display: none;" title="' + VendorNoTooltip + '">' + item.Vendor_Code + '</td>';
                                rows += '</tr>';
                            }

                            $('.PostMarketingInfotbody').html(rows);
                            $('#TblPostMarketingInfo').show();
                            $('#postp').show();

                            $('#loadingMessage4').hide();

                            var table = $('#TblPostMarketingInfo').DataTable({
                                paging: true,
                                searching: true,
                                ordering: true,
                                lengthMenu: [20, 25, 50, 100],
                                pageLength: 20,
                                language: {
                                    emptyTable: "No Data Found"
                                },
                                initComplete: function () {
                                    moveLengthDropdown();
                                },

                            });

                            function moveLengthDropdown() {

                                $('#TblPostMarketingInfo_filter').hide();
                                // Only move if it's still inside the original wrapper

                                var $length = $('#TblPostMarketingInfo_wrapper').find('#TblPostMarketingInfo_length');  // Get the length menu
                                var $target = $('#Postpage');  // Target container to move the length menu to
                                if ($target.find('#TblPostMarketingInfo_length').length) {
                                    return;
                                }
                                if ($length.length && $target.length) {  // Ensure both are present in DOM
                                    // Remove existing length menu from target if already there
                                    $target.find('#TblPostMarketingInfo_length').remove();

                                    // Append and style the length menu
                                    $length.appendTo($target).css({
                                        'margin-top': '-1px',
                                        'text-align': 'end',
                                        'display': 'inline-block'
                                    });
                                } else {
                                   // setTimeout(moveLengthDropdown, 200);
                                    console.warn("Either #TblPostMarketingInfo_length or #Postpage is missing.");
                                }
                            }
                            $('#TblPostMarketingInfo thead').on('keyup change', '.column-search', function () {

                                var columnIndex = $(this).data('column');
                                var searchValue = this.value;
                                table.column(columnIndex).search(searchValue).draw();
                            });


                        }
                    });
                     $('[data-toggle="tooltip"]').tooltip();
                 });
             }
            else if (lnkLogistics.className == "HeaderFont active")
             {

            $(document).ready(function () {
                $('#DataShowLogistics').show();
                var ObjectType = "Logistic";
               @* var urlRequest = '@Url.Action("GetGridComForList", "Commissiontracker")'; // MVC action URL
                if (urlRequest != null) {*@
                    var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
                    $('#loadingMessage5').show();         // Show spinner
                    $('#TblLogisticsInfo').hide();
                $('#Logisticss').hide();
                if ($.fn.dataTable.isDataTable('#TblLogisticsInfo')) {
                    $('#TblLogisticsInfo').DataTable().destroy();

                }
                var selectedSearchType = $('#searchType').val();
                    $.ajax({
                        url: urlRequest1,
                        type: 'GET',
                        data:
                        {
                            ObjectType: ObjectType,
                            SearchType: selectedSearchType
                        },
                        success: function (data) {

                            var totalRecords = data.length;
                            var pageLength = 20;
                            var totalPages = Math.ceil(totalRecords / pageLength);
                            var startRecord = 1;
                            var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                            $('#TblLogisticsInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                            if ($.fn.dataTable.isDataTable('#TblLogisticsInfo')) {
                                $('#TblLogisticsInfo').DataTable().destroy();
                            }
                            var rows = '';
                            for (var i = 0; i < data.length; i++) {
                                var item = data[i];

                                var siTooltip = item.SrNo;
                                var PI_noTooltip = item.PI_No;
                                var OCF_NoTooltip = item.OCF_No;
                                var Invoice_NoTooltip = item.Invoice_No;
                                var Invoice_DateTooltip = item.INV_Dates;
                                var CustomerNameTooltip = item.CustomerName;
                                var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                                var CommissionTypeTooltip = item.CommissionType;
                                var SalesPerson_NameTooltip = item.SalesPerson_Name;
                                var CommissionRateTooltip = item.CommissionRate;
                                var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                                var TaggedOnPITooltip = item.TaggedOnPI;
                                var TaggedOnOCFTooltip = item.TaggedOnOCF;
                                var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                                var Claimform_ReceivedTooltip = item.Claimform_Received;
                                var CommissionworkingsenttoVendor_EmployeeTooltip = item.CommissionworkingsenttoVendor_Employee;
                                var CommissionInvoice_ReceivedTooltip = item.CommissionInvoice_Received;
                                var Creditadvice_PreparedTooltip = item.Credit_Advice_Prepared;
                                var CreditAdviceDetailsTooltip = item.Credit_Advice_Details;
                                var FromNoTooltip = item.FromNo;
                                var VendorNoTooltip = item.Vendor_Code;
                                var ActualCommissionTooltip = item.ActualCommission;
                                rows += '<tr>';
                                rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                                rows += '<td title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                                rows += '<td title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                                rows += '<td title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                             //   var formattedClaimDate5 = formatDateToShortDMY(item.INV_Dates);
                                //rows += '<td title="' + Invoice_DateTooltip + '">' + formattedClaimDate5 + '</td>';
                                rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                                // rows += '<td title="' + PI_DateTooltip + '">' + item.PI_Date + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;"title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>'
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';

                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;" title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                                rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                                rows += '<td style="text-align: end;"  title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                                rows += '<td style="text-align: end;" title="' + ActualCommissionTooltip + '">' + item.ActualCommission + '</td>';
                                rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                                rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                                rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

                             /*   var formattedClaimDate4 = formatDateToShortDMY(item.Claimform_Received);
                                rows += '<td title="' + Claimform_ReceivedTooltip + '">' + formattedClaimDate4 + '</td>';*/
                                rows += '<td title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
                              //  var formattedClaimDate6 = formatDateToShortDMY(item.CommissionworkingsenttoVendor_Employee);
                                rows += '<td title="' + CommissionworkingsenttoVendor_EmployeeTooltip + '">' + item.CommissionworkingsenttoVendor_Employee + '</td>';
                               // rows += '<td title="' + CommissionInvoice_ReceivedTooltip + '">' + item.CommissionInvoice_Received + '</td>';
                              //  var formattedClaimDat = formatDateToShortDMY(item.CommissionInvoice_Received);
                                if (item.CommissionInvoice_Received && item.CommissionInvoice_Received.toString().toLowerCase() !== 'null') {
                                    rows += '<td title="' + (CommissionInvoice_ReceivedTooltip || '') + '">' + item.CommissionInvoice_Received + '</td>';
                                } else {
                                    rows += '<td></td>'; // or skip this line if you want to omit the cell entirely
                                }
                               // rows += '<td title="' + CommissionworkingsenttoVendor_EmployeeTooltip + '">' + item.CommissionworkingsenttoVendor_Employee + '</td>';
                                rows += '<td style="text-align: center;"><input type="checkbox" Id="CheckboxLog" class="row-checkbox All-CheckedFacyLog" /></td>';
                                rows += '<td style="text-align: center;" class="CO_Credit_Advice_Prepared" title="' + Creditadvice_PreparedTooltip + '">' + (item.Credit_Advice_Prepared || '<input style="width: 71px; text-align: center;" type="text" id="CCO_Credit_Advice_Prepared" class="input-box TextSize" onclick="showDatePicker(this);" />') + '</td>';
                                rows += '<td style="text-align: center;" class="CO_Credit_Advice_details" title="' + CreditAdviceDetailsTooltip + '">' + (item.Credit_Advice_Details || '<input style="width: 71px;    text-align: center;" type="text" id="CCO_Credit_Advice_Details" class="input-box TextSize"  />') + '</td>';
@*rows += '<td title="' + Creditadvice_PreparedTooltip + '">' + item.Credit_Advice_Prepared + '</td>';
    rows += '<td title="' + CreditAdviceDetailsTooltip + '">' + item.Credit_Advice_Details + '</td>';*@
                                rows += '<td class="FromNo" style="display: none;" title="' + FromNoTooltip + '">' + item.FromNo + '</td>';
                                rows += '<td class="Vendor_Code" style="display: none;" title="' + VendorNoTooltip + '">' + item.Vendor_Code + '</td>';
                                rows += '</tr>';
                            }

                            $('.LogisticsInfotbody').html(rows);


                            $('#loadingMessage5').hide();
                            $('#TblLogisticsInfo').show();
                            $('#Logisticss').show();
                            var table = $('#TblLogisticsInfo').DataTable({
                                paging: true,
                                searching: true,
                                ordering: true,
                                "lengthMenu": [20, 25, 50, 100],
                                "pageLength": 20,
                                language: {
                                    emptyTable: "No Data Found"
                                },
                                initComplete: function () {
                                    moveLengthDropdown();
                                },

                            });

                            function moveLengthDropdown() {

                                $('#TblLogisticsInfo_filter').hide();

                                // Only move if it's still inside the original wrapper
                                var $length = $('#TblLogisticsInfo_wrapper').find('#TblLogisticsInfo_length');  // Get the length menu
                                var $target = $('#Logpage');  // Target container to move the length menu to

                                if ($length.length && $target.length) {  // Ensure both are present in DOM
                                    // Remove existing length menu from target if already there
                                    $target.find('#TblLogisticsInfo_length').remove();

                                    // Append and style the length menu
                                    $length.appendTo($target).css({
                                        'margin-top': '-3px',
                                        'text-align': 'end',
                                        'display': 'inline-block'
                                    });
                                } else {
                                    console.warn("Either #TblLogisticsInfo_length or #Logpage is missing.");
                                }
                            }
                            $('#TblLogisticsInfo thead').on('keyup change', '.column-search', function () {
                                var columnIndex = $(this).data('column');
                                var searchValue = this.value;
                                table.column(columnIndex).search(searchValue).draw();
                            });
                            $('[data-toggle="tooltip"]').tooltip();



                        }
                    });

                   });
            }
           else if (lnkAccounts.className == "HeaderFont active")
           {
                    $(document).ready(function () {
                $('#DataShowAccounts').show();
                var ObjectType = "Account";
              @*  var urlRequest = '@Url.Action("GetGridComForList", "Commissiontracker")'; // MVC action URL
                if (urlRequest != null) {*@
                    var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
                    $('#loadingMessage6').show();         // Show spinner
                    $('#TblAccountsInfo').hide();
                        $('#Accountsf').hide();
                        var selectedSearchType = $('#searchType').val();
                    $.ajax({
                        url: urlRequest1,
                        type: 'GET',
                        data:
                        {
                            ObjectType: ObjectType,
                            SearchType: selectedSearchType


                        },
                        success: function (data) {

                            var totalRecords = data.length;
                            var pageLength = 20;
                            var totalPages = Math.ceil(totalRecords / pageLength);
                            var startRecord = 1;
                            var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                            $('#TblAccountsInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                            if ($.fn.dataTable.isDataTable('#TblAccountsInfo')) {
                                $('#TblAccountsInfo').DataTable().destroy();
                            }
                            var rows = '';
                            for (var i = 0; i < data.length; i++) {
                                var item = data[i];

                                var siTooltip = item.SrNo;
                                var PI_noTooltip = item.PI_No;
                                var OCF_NoTooltip = item.OCF_No;
                                var Invoice_NoTooltip = item.Invoice_No;
                                var Invoice_DateTooltip = item.INV_Dates;
                                var CustomerNameTooltip = item.CustomerName;
                                var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                                var CommissionTypeTooltip = item.CommissionType;
                                var SalesPerson_NameTooltip = item.SalesPerson_Name;
                                var CommissionRateTooltip = item.CommissionRate;
                                var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                                var TaggedOnPITooltip = item.TaggedOnPI;
                                var TaggedOnOCFTooltip = item.TaggedOnOCF;
                                var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                                var Claimform_ReceivedTooltip = item.Claimform_Received;
                                var CommissionworkingsenttoVendor_EmployeeTooltip = item.CommissionworkingsenttoVendor_Employee;
                                var CommissionInvoice_ReceivedTooltip = item.CommissionInvoice_Received;
                                var Credit_Advice_PreparedTooltip = item.Credit_Advice_Prepared;
                                var Credit_Note_PreparedTooltip = item.Credit_Note_Prepared;
                                var FromNoTooltip = item.FromNo;
                                var VendorNoTooltip = item.Vendor_Code;
                                var ActualCommissionTooltip = item.ActualCommission;
                                var CreditNotePreparedNoTooltip = item.CreditNotePreparedNo;
                                rows += '<tr>';
                                rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                                rows += '<td title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                                rows += '<td title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                                rows += '<td title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                                /*               var formattedClaimDate4 = formatDateToShortDMY(item.INV_Dates);
                                               rows += '<td title="' + Invoice_DateTooltip + '">' + formattedClaimDate4 + '</td>';*/
                                rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;"title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>'
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';

                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;" title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                                rows += '<td style="text-align: end;white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;"  title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                                rows += '<td  style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                                rows += '<td style="text-align: end;" title="' + ActualCommissionTooltip + '">' + item.ActualCommission + '</td>';
                                rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                                rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                                rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

                                //    var formattedClaimDate = formatDateToShortDMY(item.Claimform_Received);
                                if (item.Claimform_Received && item.Claimform_Received.toString().toLowerCase() !== 'null') {
                                    rows += '<td title="' + (Claimform_ReceivedTooltip || '') + '">' + item.Claimform_Received + '</td>';
                                } else {
                                    rows += '<td></td>'; // or skip this line if you want to omit the cell entirely
                                }
                                // rows += '<td title="' + Claimform_ReceivedTooltip + '">' + formattedClaimDate + '</td>';
                                //rows += '<td title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
                                //var formattedClaimDate6 = formatDateToShortDMY(item.CommissionworkingsenttoVendor_Employee);
                                rows += '<td title="' + CommissionworkingsenttoVendor_EmployeeTooltip + '">' + item.CommissionworkingsenttoVendor_Employee + '</td>';
                                // rows += '<td title="' + CommissionInvoice_ReceivedTooltip + '">' + item.CommissionInvoice_Received + '</td>';
                                if (item.CommissionInvoice_Received && item.CommissionInvoice_Received.toString().toLowerCase() !== 'null') {
                                    rows += '<td title="' + (CommissionInvoice_ReceivedTooltip || '') + '">' + item.CommissionInvoice_Received + '</td>';
                                } else {
                                    rows += '<td></td>'; // or skip this line if you want to omit the cell entirely
                                }
                                //  var formattedClaimDate9 = formatDateToShortDMY(item.Credit_Advice_Prepared);
                                rows += '<td title="' + Credit_Advice_PreparedTooltip + '">' + item.Credit_Advice_Prepared + '</td>';
                                //  rows += '<td title="' + Credit_Advice_PreparedTooltip + '">' + item.Credit_Advice_Prepared + '</td>';
                                rows += '<td style="text-align: center;"><input type="checkbox" Id="CheckboxFO" class="row-checkbox All-CheckedFacy" /></td>';
                                // rows += '<td class="CO_Credit_Note_Prepared" title="' + Credit_Note_PreparedTooltip + '">' + (item.Credit_Note_Prepared || '<input type="date" id="CCO_Credit_Note_Prepared" onclick="showDatePicker(this); class="input-box Freight_Bill_ForwardedSize" " />') + '</td>';
                                // rows += '<td class="CO_Credit_Note_Prepared" title="' + Credit_Note_PreparedTooltip + '">' + (item.Credit_Note_Prepared || '<input type="text" id="CCO_Credit_Note_Prepared" class="input-box Freight_Bill_ForwardedSize" onclick="showDatePicker(this);" />') + '</td>';
                                rows += '<td  style="text-align: center;" class="CO_CreditNotePreparedNo" title="' + CreditNotePreparedNoTooltip + '">' + (item.CreditNotePreparedNo || '<input type="text" style="width: 71px;    text-align: center;" id="CCO_CreditNotePreparedNo" class="input-box TextSize"  />') + '</td>';
                                rows += '<td  style="text-align: center;" class="CO_Credit_Note_Prepared" title="' + Credit_Note_PreparedTooltip + '">' + (item.Credit_Note_Prepared || '<input type="text" style="width: 71px;    text-align: center;" id="CCO_Credit_Note_Prepared" class="input-box TextSize" onclick="showDatePicker(this);" />') + '</td>';


                                rows += '<td class="FromNo" style="display: none;" title="' + FromNoTooltip + '">' + item.FromNo + '</td>';
                                rows += '<td class="Vendor_Code" style="display: none;" title="' + VendorNoTooltip + '">' + item.Vendor_Code + '</td>';
                                rows += '</tr>';
                            }


                            $('.AccountsInfotbody').html(rows);
                            $('#loadingMessage6').hide();
                            $('#TblAccountsInfo').show();
                            $('#Accountsf').show();
                            var table = $('#TblAccountsInfo').DataTable({
                                paging: true,
                                searching: true,
                                ordering: true,
                                "lengthMenu": [20, 25, 50, 100],
                                "pageLength": 20,
                                language: {
                                    emptyTable: "No Data Found"
                                },
                                initComplete: function () {
                                    moveLengthDropdown();
                                },
                                drawCallback: function () {
                                    moveLengthDropdown();
                                }
                            });

                            function moveLengthDropdown() {

                                $('#TblAccountsInfo_filter').hide();

                                // Only move if it's still inside the original wrapper
                                var $length = $('#TblAccountsInfo_wrapper').find('#TblAccountsInfo_length');  // Get the length menu
                                var $target = $('#Accountpage');  // Target container to move the length menu to

                                if ($length.length && $target.length) {  // Ensure both are present in DOM
                                    // Remove existing length menu from target if already there
                                    $target.find('#TblAccountsInfo_length').remove();

                                    // Append and style the length menu
                                    $length.appendTo($target).css({
                                        'margin-top': '-3px',
                                        'text-align': 'end',
                                        'display': 'inline-block'
                                    });
                                } else {
                                    console.warn("Either #TblAccountsInfo_length or #Accountpage is missing.");
                                }
                            }
                            $('#TblAccountsInfo thead').on('keyup change', '.column-search', function () {
                                var columnIndex = $(this).data('column');
                                var searchValue = this.value;
                                table.column(columnIndex).search(searchValue).draw();
                            });
                            $('[data-toggle="tooltip"]').tooltip();



                        }

                    });

                   });
           }
            else {
                       $(document).ready(function () {

@*      var urlRequest = '@Url.Action("GetGridComForList", "Commissiontracker")'; // MVC action URL
      if (urlRequest != null) {*@
      $('#DataShowList').show();
          var urlRequest1 = '@Url.Action("GetGridCommissionListTile", "Common")';
             $('#invoiceNoSearchSectionList').hide();

             var selectedSearchType = $('#searchType').val();

             $('#loadingMessage1').show();         // Show spinner
             $('#TblcommissionInfo').hide();
              $.ajax({
                  url: urlRequest1,
                  type: 'GET',
                  data: { SearchType: selectedSearchType},
                  success: function (data) {

                      var totalRecords = data.length;
                      var pageLength = 20;
                      var totalPages = Math.ceil(totalRecords / pageLength);
                      var startRecord = 1;
                      var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                      $('#TblcommissionInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                      if ($.fn.dataTable.isDataTable('#TblcommissionInfo')) {
                          $('#TblcommissionInfo').DataTable().destroy();
                      }
                      var rows = '';
                      for (var i = 0; i < data.length; i++) {
                          var item = data[i];

                          var siTooltip = item.SrNo;
                          var PI_noTooltip = item.PI_No;
                          var OCF_NoTooltip = item.OCF_No;
                          var Invoice_NoTooltip = item.Invoice_No;
                          var Invoice_DateTooltip = item.INV_Dates;
                          var CustomerNameTooltip = item.CustomerName;
                          var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                          var CommissionTypeTooltip = item.CommissionType;
                          var CommissionRateTooltip = item.CommissionRate;
                          var SalesPerson_NameTooltip = item.SalesPerson_Name;
                          var TentativeComm_AmtTooltip = item.TentativeCommBasic_Amt;
                          var TaggedOnPITooltip = item.TaggedOnPI;
                          var TaggedOnOCFTooltip = item.TaggedOnOCF;
                          var TaggedafterinvoiceTooltip = item.TaggedAfterInvoice;
                          var Claimform_ReceivedTooltip = item.Claimform_Received;
                          var CommissionworkingsenttoVendor_EmployeeTooltip = item.CommissionworkingsenttoVendor_Employee;
                          var CommissionInvoice_ReceivedTooltip = item.CommissionInvoice_Received;
                          var Credit_Note_PreparedTooltip = item.Credit_Note_Prepared;
                          var CreditAdviceDetailsTooltip = item.Credit_Advice_Details;
                          var Vendor_CodeTooltip = item.Vendor_Code;
                          var ActualCommissionTooltip = item.ActualCommission;
                          var CreditAdvicePreparedTooltip = item.Credit_Advice_Prepared;
                          let CreditNotePreparedNoTooltip = item.CreditNotePreparedNo
                          let creditnotepreparedvalue = item.Credit_Note_Prepared
                          let rowClass = '';
                          debugger
                          if (creditnotepreparedvalue && creditnotepreparedvalue.trim() !== '') {
                              rowClass = 'tr-green'; // make it green if has value
                          }
                          else { rowClass = ''; }
                          rows += `<tr class="${rowClass}">`;
                          rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                          rows += '<td class="PI_No" title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                          rows += '<td class="OCF_No" title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                          rows += '<td class="Invoice_No" title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                          //  var formattedClaimDate5 = formatDateToShortDMY(item.INV_Dates);
                          rows += '<td title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                          // rows += '<td  title="' + Invoice_DateTooltip + '">' + item.INV_Dates + '</td>';
                          rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                          rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                          rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
                          rows += '<td  style="text-align: end;" title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                          rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;"  title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                          rows += '<td style="text-align: end;" title="' + TentativeComm_AmtTooltip + '">' + item.TentativeCommBasic_Amt + '</td>';
                          rows += '<td style="text-align: end;" title="' + ActualCommissionTooltip + '">' + item.ActualCommission + '</td>';
                          rows += '<td title="' + CommissionworkingsenttoVendor_EmployeeTooltip + '">' + item.CommissionworkingsenttoVendor_Employee + '</td>';
                          rows += '<td title="' + CommissionInvoice_ReceivedTooltip + '">' + item.CommissionInvoice_Received + '</td>';
                          rows += '<td title="' + Claimform_ReceivedTooltip + '">' + item.Claimform_Received + '</td>';
                          rows += '<td title="' + CreditAdvicePreparedTooltip + '">' + item.Credit_Advice_Prepared + '</td>';
                          rows += '<td class="" title="' + CreditAdviceDetailsTooltip + '">' + item.Credit_Advice_Details + '</td>';
                          rows += '<td class="" title="' + CreditNotePreparedNoTooltip + '">' + item.CreditNotePreparedNo + '</td>';
                          rows += '<td title="' + Credit_Note_PreparedTooltip + '">' + item.Credit_Note_Prepared + '</td>';
                          rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                          rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';

                          rows += '<td title="' + TaggedafterinvoiceTooltip + '" style="text-align:center;">' + (item.TaggedAfterInvoice ? 'Yes' : '--') + '</td>';

                          //     var formattedClaimDate1 = formatDateToShortDMY(item.Claimform_Received);


                          // var formattedClaimDate = formatDateToShortDMY(item.CommissionworkingsenttoVendor_Employee);


                          // var formattedClaimDate2 = formatDateToShortDMY(item.CommissionInvoice_Received);



                          rows += '<td title="' + Vendor_CodeTooltip + '">' + item.Vendor_Code + '</td>';
                          rows += '</tr>';
                      }
                      $('.commissionInfotbody').html(rows);

                      $('#invoiceNoSearchSectionList').show();
                      $('#loadingMessage1').hide();
                      $('#TblcommissionInfo').show();
                      var table = $('#TblcommissionInfo').DataTable({
                          paging: true,
                          searching: true,
                          ordering: true,
                          lengthMenu: [20, 25, 50, 100],
                          pageLength: 20,
                          language: {
                              emptyTable: "No Data Found"
                          },
                          initComplete: function () {
                              moveLengthDropdown();
                          },
                          drawCallback: function () {
                              moveLengthDropdown();
                          }
                      });

                      function moveLengthDropdown() {

                          $('#TblcommissionInfo_filter').hide();
                          // Only move if it's still inside the original wrapper
                          var $length = $('#TblcommissionInfo_wrapper').find('#TblcommissionInfo_length');  // Get the length menu
                          var $target = $('#commissionpage');  // Target container to move the length menu to

                          if ($length.length && $target.length) {  // Ensure both are present in DOM
                              // Remove existing length menu from target if already there
                              $target.find('#TblcommissionInfo_length').remove();

                              // Append and style the length menu
                              $length.appendTo($target).css({
                                  'margin-top': '5px',
                                  'text-align': 'end',
                                  'display': 'inline-block'
                              });
                          } else {
                              console.warn("Either #TblcommissionInfo_length or #commissionpage is missing.");
                          }
                      }
                      $('#TblcommissionInfo thead').on('keyup change', '.column-search', function () {

                          var columnIndex = $(this).data('column');
                          var searchValue = this.value;
                          table.column(columnIndex).search(searchValue).draw();
                      });
                  }


              });
             $('a[data-toggle="tab"]').on('shown.bs.tab', function () {
                 $('#TblcommissionInfo').DataTable().columns.adjust().draw();
             });
          $('[data-toggle="tooltip"]').tooltip();
                           $('#TblcommissionInfo tbody').on('dblclick', 'tr', function () {
                               debugger
                               autoClickTab('#lnkDetail');
                               var table = $('#TblcommissionInfo').DataTable();
                               var rowData = table.row(this).data(); // Get the row data
                               console.log(rowData);
                               $("#PI_No").val(rowData[1]);
                               $("#OCF_No").val(rowData[2]);
                               $("#Invoice_No").val(rowData[3]);
                               $("#INV_Dates").val(rowData[4]);
                               $("#CustomerName").val(rowData[5]);
                               $("#Commission_Vendor_Name").val(rowData[6]);
                               $("#CommissionType").val(rowData[7]);
                               $("#CommissionRate").val(rowData[8]);
                               $("#SalesPerson_Name").val(rowData[9]);
                               $("#TentativeCommBasic_Amt").val(rowData[10]);
                               //   $("#ActualCommission").val(rowData[11]);
                               var actualCommission = rowData[11];

                               if (actualCommission !== null && actualCommission !== undefined && actualCommission != 0) {
                                   // Disable the textbox if value is NOT 0 and NOT null
                                   $("#ActualCommission").val(actualCommission).prop("disabled", true);
                               } else {
                                   // Enable the textbox if value is 0 or null
                                   $("#ActualCommission").val('').prop("disabled", false);
                               }
                               $("#CommissionworkingsenttoVendor_Employee").val(rowData[12]);
                               $("#CommissionInvoice_Received").val(rowData[13]);
                               $("#Claimform_Received").val(rowData[14]);

                               $("#Credit_Advice_Prepared").val(rowData[15]);
                               $("#Credit_Advice_Details").val(rowData[16]);
                               $("#CreditNotePreparedNo").val(rowData[17]);



                               $("#Credit_Note_Prepared").val(rowData[18]);
                               if (rowData[19] == "Yes") {
                                   $("#TaggedOnPI").prop("checked", true);
                               }
                               else {
                                   $("#TaggedOnPI").prop("checked", false);
                               }
                               //  $("#TaggedOnPI").val(rowData[11]);
                               if (rowData[20] == "Yes") {
                                   $("#TaggedOnOCF").prop("checked", true);
                               }
                               else {
                                   $("#TaggedOnOCF").prop("checked", false);
                               }
                               if (rowData[21] == "Yes") {
                                   $("#TaggedAfterInvoice").prop("checked", true);
                               }
                               else {
                                   $("#TaggedAfterInvoice").prop("checked", false);
                               }

                               $("#Vendor_Code").val(rowData[22]);
                           });




  });
                      @*$(document).ready(function () {
                          $('#DataShowPI').show();
                    var urlRequest1 = '@Url.Action("GetGridListComForPIStatus", "Common")';
                    $('#loadingMessage').show();
                    $('#TblPIListInfo').hide();
                    $.ajax({
                        url: urlRequest1,
                        type: 'GET',
                        data:
                        {


                        },


                        success: function (data) {

                            var totalRecords = data.length;
                            var pageLength = 10;
                            var totalPages = Math.ceil(totalRecords / pageLength);
                            var startRecord = 1;
                            var endRecord = totalRecords < pageLength ? totalRecords : pageLength;

                            $('#TblPIListInfo_info').text('Showing ' + startRecord + ' to ' + endRecord + ' of ' + totalRecords + ' entries');
                            if ($.fn.dataTable.isDataTable('#TblPIListInfo')) {
                                $('#TblPIListInfo').DataTable().destroy();
                            }
                            var rows = '';
                            for (var i = 0; i < data.length; i++) {
                                var item = data[i];

                                var siTooltip = item.SrNo;
                                var PI_noTooltip = item.PI_No;
                                var OCF_NoTooltip = item.OCF_No;
                                var Invoice_NoTooltip = item.Invoice_No;
                                var PI_DateTooltip = item.PI_Date;
                                var CustomerNameTooltip = item.CustomerName;
                                var Commission_Vendor_NameTooltip = item.Commission_Vendor_Name;
                                var CommissionTypeTooltip = item.CommissionType;
                                var CommissionRateTooltip = item.CommissionRate;
                                var SalesPerson_NameTooltip = item.SalesPerson_Name;

                                var TaggedOnPITooltip = item.TaggedOnPI;
                                var TaggedOnOCFTooltip = item.TaggedOnOCF;
                                var TaggedOnINVTooltip = item.TaggedOnINV;

                                rows += '<tr>';
                                rows += '<td  title="' + siTooltip + '">' + item.SrNo + '</td>';
                                rows += '<td title="' + PI_noTooltip + '">' + item.PI_No + '</td>';
                                rows += '<td title="' + OCF_NoTooltip + '">' + item.OCF_No + '</td>';
                                rows += '<td title="' + Invoice_NoTooltip + '">' + item.Invoice_No + '</td>';
                                var formattedClaimDate1 = formatDateToShortDMY(item.PI_Date);
                                rows += '<td title="' + PI_DateTooltip + '">' + formattedClaimDate1 + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 132px;" title="' + CustomerNameTooltip + '">' + item.CustomerName + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;"title="' + Commission_Vendor_NameTooltip + '">' + item.Commission_Vendor_Name + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;" title="' + CommissionTypeTooltip + '">' + item.CommissionType + '</td>';
                                rows += '<td  style="text-align: end;white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 70px;"title="' + CommissionRateTooltip + '">' + item.CommissionRate + '</td>';
                                rows += '<td style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 115px;" title="' + SalesPerson_NameTooltip + '">' + item.SalesPerson_Name + '</td>';
                                rows += '<td title="' + TaggedOnPITooltip + '" style="text-align:center;">' + (item.TaggedOnPI ? 'Yes' : '--') + '</td>';
                                rows += '<td title="' + TaggedOnOCFTooltip + '" style="text-align:center;">' + (item.TaggedOnOCF ? 'Yes' : '--') + '</td>';
                                rows += '<td title="' + TaggedOnINVTooltip + '" style="text-align:center;">' + (item.TaggedOnINV ? 'Yes' : '--') + '</td>';
                                rows += '</tr>';
                            }

                            $('.Infotbody').html(rows);
                            $('#loadingMessage').hide();
                            $('#TblPIListInfo').show();
                            var table = $('#TblPIListInfo').DataTable({
                                "paging": true,
                                "searching": true,

                                "ordering": true,
                                "lengthMenu": [10,15,20, 25, 50, 100],
                                "pageLength": 10,
                                "language": {
                                    emptyTable: "No Data Found"
                                },
                                "initComplete": function (settings, json) {
                                    $('#TblPIListInfo_filter').hide();
                                }

                            })
                            $('#TblPIListInfo thead').on('keyup change', '.column-search', function () {
                                var columnIndex = $(this).data('column');
                                var searchValue = this.value;
                                table.column(columnIndex).search(searchValue).draw();
                            });
                        }



                    });
                    $('[data-toggle="tooltip"]').tooltip();
                $('#TblPIListInfo tbody').on('dblclick', 'tr', function () {

                        autoClickTab('#lnkDetail');
                        var table = $('#TblPIListInfo').DataTable();
                        var rowData = table.row(this).data(); // Get the row data
                        $("#PI_No").val(rowData[1]);
                        $("#OCF_No").val(rowData[2]);
                        $("#Invoice_No").val(rowData[3]);
                        $("#PI_Date").val(rowData[4]);
                        $("#CustomerName").val(rowData[5]);
                        $("#Commission_Vendor_Name").val(rowData[6]);
                        $("#CommissionType").val(rowData[7]);
                        $("#CommissionRate").val(rowData[8]);
                        $("#SalesPerson_Name").val(rowData[9]);
                    if (rowData[10] == "Yes") {
                            $("#TaggedOnPI").prop("checked", true);
                        }
                        else {
                            $("#TaggedOnPI").prop("checked", false);
                        }
                    if (rowData[11] == "Yes") {
                            $("#TaggedOnOCF").prop("checked", true);
                        }
                        else {
                            $("#TaggedOnOCF").prop("checked", false);
                        }
                    if (rowData[12] == "Yes") {
                            $("#TaggedOnINV").prop("checked", true);
                        }
                        else {
                            $("#TaggedOnINV").prop("checked", false);
                        }

                    });

                      });*@

                }
    }

    function autoClickTab(tabId) {

            const tab = document.getElementById(tabId);
            if (tab) { tab.click(); }
        }
    $('#SelectAll').click(function () {
        $('.All-CheckedFacy').prop('checked', this.checked);
    });

</script>

@section scripts
        {
    <script src="~/WebFormScripts/ExtOperation.js"></script>
    <link href="~/Content/Css/TSCommon.css" rel="stylesheet" />
    <script src="~/Content/plugins/datatables/jquery.dataTables.min.js"></script>
}
